<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Benchmarking normalization, aggregation and models using the Ionstar Dataset â€¢ prolfqua</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Benchmarking normalization, aggregation and models using the Ionstar Dataset">
<meta property="og:description" content="prolfqua">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prolfqua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Auxiliary_ExDesignSurvey.html">Auxiliary - Bioinformatics Project Meeting Agenda</a>
    </li>
    <li>
      <a href="../articles/Auxiliary_LFQSurvey.html">Auxiliary - Project meeting (bioinfo) Agenda</a>
    </li>
    <li>
      <a href="../articles/Auxiliary_prolfquaAbstract_2.html">Auxiliary - Euro Bioconductor 2020</a>
    </li>
    <li>
      <a href="../articles/BenchmarkingIonstarData.html">Benchmarking normalization, aggregation and models using the Ionstar Dataset</a>
    </li>
    <li>
      <a href="../articles/Comparing2Groups.html">Comparing Two Groups</a>
    </li>
    <li>
      <a href="../articles/CreatingConfigurations.html">Creating prolfqua Configurations</a>
    </li>
    <li>
      <a href="../articles/Modelling2Factors.html">Modelling Dataset with two Factors.</a>
    </li>
    <li>
      <a href="../articles/QualityControlAndSampleSizeEstimation.html">QC and Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary.html">Supplement - Summarize SRM Peptide Level Measurements</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary_HL.html">Supplement - Summarize heavy light Peptide Level Measurements</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_HL_Skyline.html">Supplement - Data preprocessing of SRM Heavy Light data</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_Skyline_PRM.html">Supplement - Data preprocessing for PRM</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyCorrelationAnalysis.html">Supplement - Filter precursors or fragments based on correlation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolski/prolfqua/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BenchmarkingIonstarData_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Benchmarking normalization, aggregation and models using the Ionstar Dataset</h1>
                        <h4 class="author">FGCZ - (Draft)</h4>
            
            <h4 class="date">05 March, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolski/prolfqua/blob/master/vignettes/BenchmarkingIonstarData.Rmd"><code>vignettes/BenchmarkingIonstarData.Rmd</code></a></small>
      <div class="hidden name"><code>BenchmarkingIonstarData.Rmd</code></div>

    </div>

    
    
<p>Please download and install the <code>prolfquaData</code> package from github</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/conflicted">conflicted</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wolski/prolfqua">prolfqua</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/conflicted/man/conflict_prefer.html">conflict_prefer</a></span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></code></pre></div>
<p>We start by loading the IonStar dataset and the annotation from the <code>prolfquaData</code> package. The method <code>add_annotation</code> adds the annotation to the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datadir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="st">"prolfquaData"</span><span class="op">)</span> , <span class="st">"quantdata"</span><span class="op">)</span>
<span class="va">inputMQfile</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"MaxQuant_Ionstar2018_PXD003881.zip"</span><span class="op">)</span>
<span class="va">inputAnnotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"annotation_Ionstar2018_PXD003881.xlsx"</span><span class="op">)</span>

<span class="va">mqdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidyMQ_Peptides_Config.html">tidyMQ_Peptides_Config</a></span><span class="op">(</span><span class="va">inputMQfile</span><span class="op">)</span>
<span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="va">inputAnnotation</span><span class="op">)</span>


<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_annotation.html">add_annotation</a></span><span class="op">(</span>
  <span class="va">mqdata</span><span class="op">$</span><span class="va">data</span>,
  <span class="va">annotation</span>,
  fileName <span class="op">=</span> <span class="st">"raw.file"</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">factors</span><span class="op">[[</span><span class="st">"dilution."</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="st">"sample"</span>
<span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">factors</span><span class="op">[[</span><span class="st">"run_Id"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="st">"run_ID"</span>
<span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">factorDepth</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">mqdata</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_analysis.html">setup_analysis</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datafilt</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_proteins_by_peptide_count.html">filter_proteins_by_peptide_count</a></span><span class="op">(</span><span class="va">mqdata</span><span class="op">$</span><span class="va">data</span>, <span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></code></pre></div>
<div id="normalize-data-using-human-proteins-only" class="section level2">
<h2 class="hasAnchor">
<a href="#normalize-data-using-human-proteins-only" class="anchor"></a>Normalize data using HUMAN proteins only</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqdata</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">datafilt</span>, <span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">)</span>
<span class="va">tr</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Transformer</span><span class="op">(</span><span class="op">)</span>

<span class="va">subset_h</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span>
<span class="va">subset_h</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">subset_h</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"HUMAN"</span>, <span class="va">protein_Id</span><span class="op">)</span><span class="op">)</span>
<span class="va">lfqdataNormalized</span> <span class="op">&lt;-</span> <span class="va">tr</span><span class="op">$</span><span class="fu">log2_robscale_subset</span><span class="op">(</span>lfqsubset <span class="op">=</span> <span class="va">subset_h</span><span class="op">)</span></code></pre></div>
<p>The figures below show the intensity distribution before and after normalization.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">before</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">before</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/PlotIntensityDistributions-1.png" width="960"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">after</span> <span class="op">&lt;-</span> <span class="va">lfqdataNormalized</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">after</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/PlotIntensityDistributions-2.png" width="960"></p>
<p>Create a sample of N proteins to speed up computations of models and contrasts.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="va">hk</span> <span class="op">&lt;-</span> <span class="va">mqdata</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">hkeysDepth</span><span class="op">(</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
<span class="va">protein_Ids</span> <span class="op">&lt;-</span> <span class="va">mqdata</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">hk</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">N</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
<span class="va">protein_Ids</span> <span class="op">&lt;-</span> <span class="va">mqdata</span><span class="op">$</span><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">hk</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#%&gt;%</span>
  <span class="co">#sample_n(size = N)</span>
<span class="op">}</span>

<span class="va">lfqNormSubset</span> <span class="op">&lt;-</span> <span class="va">lfqdataNormalized</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span>
<span class="va">lfqNormSubset</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">protein_Ids</span>, <span class="va">lfqNormSubset</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>
<span class="va">mqdataSubset</span> <span class="op">&lt;-</span> <span class="va">mqdata</span>
<span class="va">mqdataSubset</span><span class="op">$</span><span class="va">data</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">protein_Ids</span>, <span class="va">mqdata</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></code></pre></div>
</div>
<div id="infer-protein-intensities-using-tukeys-median-polish" class="section level1">
<h1 class="hasAnchor">
<a href="#infer-protein-intensities-using-tukeys-median-polish" class="anchor"></a>Infer Protein intensities using Tukeys Median Polish</h1>
<p>We will be using the <code>LFQDataAggregator</code> class. To estimate protein intensities using Tukeyâ€™s median polish we need to use normalized data. The figure below shows the the protein estimates (dashed line) and the peptide intensities.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqAggMedpol</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LFQDataAggregator.html">LFQDataAggregator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">lfqNormSubset</span>, <span class="st">"protein"</span><span class="op">)</span>
<span class="va">lfqAggMedpol</span><span class="op">$</span><span class="fu">medpolish</span><span class="op">(</span><span class="op">)</span>
<span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">lfqAggMedpol</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span>
<span class="va">xx</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>We can also estimate the protein intensities using the top N most abundant peptides. In this case we are using the untransformed protein intensities. The figure below shows the estimated protein intensities.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqAggregator</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LFQDataAggregator.html">LFQDataAggregator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mqdataSubset</span><span class="op">$</span><span class="va">data</span>, <span class="va">mqdataSubset</span><span class="op">$</span><span class="va">config</span><span class="op">)</span>, <span class="st">"protein_topN"</span><span class="op">)</span>
<span class="va">lfqAggregator</span><span class="op">$</span><span class="fu">mean_topN</span><span class="op">(</span><span class="op">)</span>
<span class="va">topN</span> <span class="op">&lt;-</span> <span class="va">lfqAggregator</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span>
<span class="va">topN</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/unnamed-chunk-8-1.png" width="960"></p>
</div>
<div id="fitting-a-linear-model-to-the-protein-intensities" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-a-linear-model-to-the-protein-intensities" class="anchor"></a>Fitting a linear model to the protein intensities</h1>
<p>To fit the linear models we will be using the protein intensities estimated using the Tukeys median polish.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DEBUG</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>

<span class="va">Contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"dilution_(9/3)_3"</span> <span class="op">=</span>   <span class="st">"dilution.e - dilution.a"</span>,
  <span class="st">"dilution_(9/4.5)_2"</span> <span class="op">=</span>   <span class="st">"dilution.e - dilution.b"</span>,
  <span class="st">"dilution_(9/6)_1.5"</span> <span class="op">=</span>   <span class="st">"dilution.e - dilution.c"</span>,
  <span class="st">"dilution_(9/7.5)_1.2"</span> <span class="op">=</span>   <span class="st">"dilution.e - dilution.d"</span>,
  
  <span class="st">"dilution_(7.5/3)_2.5"</span> <span class="op">=</span>   <span class="st">"dilution.d - dilution.a"</span>,
  <span class="st">"dilution_(7.5/4.5)_1.6(6)"</span> <span class="op">=</span>   <span class="st">"dilution.d - dilution.b"</span>,
  <span class="st">"dilution_(7.5/6)_1.25"</span> <span class="op">=</span>   <span class="st">"dilution.d - dilution.c"</span>,
  
  <span class="st">"dilution_(6/3)_2"</span> <span class="op">=</span>   <span class="st">"dilution.c - dilution.a"</span>,
  <span class="st">"dilution_(6/4.5)_1.3(3)"</span> <span class="op">=</span>   <span class="st">"dilution.c - dilution.b"</span>,
  
  <span class="st">"dilution_(4.5/3)_1.5"</span> <span class="op">=</span>   <span class="st">"dilution.b - dilution.a"</span>
<span class="op">)</span>


<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Contrasts</span><span class="op">)</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ratio"</span> , <span class="st">"expected fold-change"</span><span class="op">)</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span><span class="va">tt</span>, contrast <span class="op">=</span>  <span class="va">Contrasts</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">tt</span>, caption <span class="op">=</span> <span class="st">"All possible Contrasts given 5 E. coli dilutions of the Ionstar Dataset"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>All possible Contrasts given 5 E. coli dilutions of the Ionstar Dataset</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">contrast</th>
<th align="left">ratio</th>
<th align="left">expected fold-change</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">init</td>
<td align="left">dilution.e - dilution.a</td>
<td align="left">(9/3)</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">X</td>
<td align="left">dilution.e - dilution.b</td>
<td align="left">(9/4.5)</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">X.1</td>
<td align="left">dilution.e - dilution.c</td>
<td align="left">(9/6)</td>
<td align="left">1.5</td>
</tr>
<tr class="even">
<td align="left">X.2</td>
<td align="left">dilution.e - dilution.d</td>
<td align="left">(9/7.5)</td>
<td align="left">1.2</td>
</tr>
<tr class="odd">
<td align="left">X.3</td>
<td align="left">dilution.d - dilution.a</td>
<td align="left">(7.5/3)</td>
<td align="left">2.5</td>
</tr>
<tr class="even">
<td align="left">X.4</td>
<td align="left">dilution.d - dilution.b</td>
<td align="left">(7.5/4.5)</td>
<td align="left">1.6(6)</td>
</tr>
<tr class="odd">
<td align="left">X.5</td>
<td align="left">dilution.d - dilution.c</td>
<td align="left">(7.5/6)</td>
<td align="left">1.25</td>
</tr>
<tr class="even">
<td align="left">X.6</td>
<td align="left">dilution.c - dilution.a</td>
<td align="left">(6/3)</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">X.7</td>
<td align="left">dilution.c - dilution.b</td>
<td align="left">(6/4.5)</td>
<td align="left">1.3(3)</td>
</tr>
<tr class="even">
<td align="left">X.8</td>
<td align="left">dilution.b - dilution.a</td>
<td align="left">(4.5/3)</td>
<td align="left">1.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relevantContrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dilution_(9/7.5)_1.2"</span>,
                       <span class="st">"dilution_(7.5/6)_1.25"</span>,
                       <span class="st">"dilution_(6/4.5)_1.3(3)"</span>,
                       <span class="st">"dilution_(4.5/3)_1.5"</span> <span class="op">)</span>

<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">relevantContrasts</span>,split <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ratio"</span> , <span class="st">"expected fold-change"</span><span class="op">)</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span><span class="va">tt</span>, contrast <span class="op">=</span>  <span class="va">Contrasts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Contrasts</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">relevantContrasts</span><span class="op">]</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">tt</span>, caption <span class="op">=</span> <span class="st">"Contrasts used for benchmark."</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Contrasts used for benchmark.</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">contrast</th>
<th align="left">ratio</th>
<th align="left">expected fold-change</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">init</td>
<td align="left">dilution.e - dilution.d</td>
<td align="left">(9/7.5)</td>
<td align="left">1.2</td>
</tr>
<tr class="even">
<td align="left">X</td>
<td align="left">dilution.d - dilution.c</td>
<td align="left">(7.5/6)</td>
<td align="left">1.25</td>
</tr>
<tr class="odd">
<td align="left">X.1</td>
<td align="left">dilution.c - dilution.b</td>
<td align="left">(6/4.5)</td>
<td align="left">1.3(3)</td>
</tr>
<tr class="even">
<td align="left">X.2</td>
<td align="left">dilution.b - dilution.a</td>
<td align="left">(4.5/3)</td>
<td align="left">1.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relevantContrasts</span> <span class="op">&lt;-</span> <span class="va">Contrasts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Contrasts</span><span class="op">)</span> <span class="op">%in%</span> <span class="va">relevantContrasts</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">protLFQ</span> <span class="op">&lt;-</span> <span class="va">lfqAggMedpol</span><span class="op">$</span><span class="va">lfq_agg</span>

<span class="va">lmmodel</span> <span class="op">&lt;-</span> <span class="st">"~ dilution."</span>
<span class="va">lmmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">protLFQ</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">getWorkIntensity</span><span class="op">(</span><span class="op">)</span> , <span class="va">lmmodel</span><span class="op">)</span>

<span class="va">modelFunction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_custom_model_lm.html">make_custom_model_lm</a></span><span class="op">(</span> <span class="va">lmmodel</span>, model_name <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span>

<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/build_model.html">build_model</a></span><span class="op">(</span><span class="va">protLFQ</span><span class="op">$</span><span class="va">data</span>, <span class="va">modelFunction</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/ContrastsModerated.html">ContrastsModerated</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, <span class="va">relevantContrasts</span><span class="op">)</span>
<span class="va">contrdf</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span>
<span class="va">cp</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">cp</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## $FDR.moderated</code></pre>
<p><img src="BenchmarkingIonstarData_files/figure-html/computeContrastsModerated-1.png" width="960"></p>
</div>
<div id="benchmarking" class="section level1">
<h1 class="hasAnchor">
<a href="#benchmarking" class="anchor"></a>Benchmarking</h1>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ttd</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/ionstar_bench_preprocess.html">ionstar_bench_preprocess</a></span><span class="op">(</span><span class="va">contrdf</span><span class="op">)</span>
<span class="va">medpol_benchmark</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_benchmark.html">make_benchmark</a></span><span class="op">(</span><span class="va">ttd</span><span class="op">$</span><span class="va">data</span>,
                                   model_description <span class="op">=</span> <span class="st">"med. polish and lm. density"</span>,
                                   model_name <span class="op">=</span> <span class="st">"prot_med_lm"</span>,
                                   FDRvsFDP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sc <span class="op">=</span> <span class="st">"FDR"</span>, desc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                                                  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sc <span class="op">=</span> <span class="st">"FDR.moderated"</span>, desc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 16,120 x 22
##    contrast protein_Id     c1     c2 c1_name c2_name  sigma    df estimate
##    &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;
##  1 dilutio~ sp|A0A0U1~ NA     -1.94  diluti~ diluti~ 0.192      1  NA     
##  2 dilutio~ sp|A0AVT1~ -1.19  -1.27  diluti~ diluti~ 0.135     15   0.0852
##  3 dilutio~ sp|A0FGR8~ -0.231 -0.311 diluti~ diluti~ 0.0848    15   0.0791
##  4 dilutio~ sp|A0MZ66~ -1.23  -1.14  diluti~ diluti~ 0.115     15  -0.0907
##  5 dilutio~ sp|A1L0T0~ -1.45  -1.48  diluti~ diluti~ 0.287     15   0.0326
##  6 dilutio~ sp|A1X283~ -1.74  -1.51  diluti~ diluti~ 0.267     15  -0.235 
##  7 dilutio~ sp|A2RRP1~ -2.53  -2.30  diluti~ diluti~ 0.155     14  -0.228 
##  8 dilutio~ sp|A3KN83~ -1.90  -2.03  diluti~ diluti~ 0.323     15   0.128 
##  9 dilutio~ sp|A4D1E9~ -1.28  -1.49  diluti~ diluti~ 0.163     15   0.212 
## 10 dilutio~ sp|A5PLL7~ -2.11  -2.05  diluti~ diluti~ 0.296     15  -0.0595
## # ... with 16,110 more rows, and 13 more variables: std.error &lt;dbl&gt;,
## #   statistic &lt;dbl&gt;, p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;,
## #   isSingular &lt;lgl&gt;, FDR &lt;dbl&gt;, moderated.p.value &lt;dbl&gt;, FDR.moderated &lt;dbl&gt;,
## #   species &lt;chr&gt;, TP &lt;lgl&gt;, scaled.p.value &lt;dbl&gt;,
## #   scaled.moderated.p.value &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">plot_score_distribution</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmark-1.png" width="960"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">plot_ROC</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmark-2.png" width="960"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">plot_FDRvsFDP</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmark-3.png" width="960"></p>
</div>
<div id="imputation" class="section level1">
<h1 class="hasAnchor">
<a href="#imputation" class="anchor"></a>Imputation</h1>
<p>In order to estimate fold-changes of proteins for which linear models could not be fitted because of an excess of missing measurements, the following procedure is applied: The mean intensity of a peptide over all samples in a condition is computed. For the proteins with no observation in one condition, we imputed the peptide intensities using the mean of the 10% smallest average peptide intensities determined in step one. Then the fold changes between conditions were estimated for each peptide, and the median of the peptide fold change estimates was used to provide a per protein fold change. No p-values were estimated in this case.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contrsimple</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/ContrastsSimpleImpute.html">ContrastsSimpleImpute</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">lfqNormSubset</span>, <span class="va">relevantContrasts</span><span class="op">)</span>

<span class="va">cs</span> <span class="op">&lt;-</span> <span class="va">contrsimple</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span>
<span class="va">cs</span> <span class="op">&lt;-</span> <span class="va">cs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">estimate_median</span><span class="op">)</span>
<span class="va">ttd</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/ionstar_bench_preprocess.html">ionstar_bench_preprocess</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span>
<span class="va">ttd</span><span class="op">$</span><span class="va">data</span></code></pre></div>
<pre><code>## # A tibble: 16,120 x 14
##    contrast protein_Id c1_name c2_name     c1     c2     n estimate estimate_mad
##    &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;        &lt;dbl&gt;
##  1 dilutio~ sp|A0A0U1~ diluti~ diluti~ -2.02  -2.10      2   0.0762       0.113 
##  2 dilutio~ sp|A0AVT1~ diluti~ diluti~ -1.27  -1.28     12  -0.0292       0.164 
##  3 dilutio~ sp|A0FGR8~ diluti~ diluti~ -0.594 -0.367    16   0.0760       0.427 
##  4 dilutio~ sp|A0MZ66~ diluti~ diluti~ -1.15  -1.21     10  -0.0484       0.0942
##  5 dilutio~ sp|A1L0T0~ diluti~ diluti~ -1.33  -1.57      5  -0.172        0.147 
##  6 dilutio~ sp|A1X283~ diluti~ diluti~ -1.78  -1.69      5  -0.0226       0.612 
##  7 dilutio~ sp|A2RRP1~ diluti~ diluti~ -2.46  -2.22      4  -0.200        0.353 
##  8 dilutio~ sp|A3KN83~ diluti~ diluti~ -2.02  -2.00      5  -0.0153       0.0227
##  9 dilutio~ sp|A4D1E9~ diluti~ diluti~ -1.32  -1.68      5   0.197        0.253 
## 10 dilutio~ sp|A5PLL7~ diluti~ diluti~ -1.82  -2.02      3  -0.236        0.889 
## # ... with 16,110 more rows, and 5 more variables: isSingular &lt;lgl&gt;,
## #   statistic &lt;dbl&gt;, p.value &lt;dbl&gt;, species &lt;chr&gt;, TP &lt;lgl&gt;</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medpol_benchmark</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_benchmark.html">make_benchmark</a></span><span class="op">(</span><span class="va">ttd</span><span class="op">$</span><span class="va">data</span>,
                                   model_description <span class="op">=</span> <span class="st">"imputed data"</span>,
                                   model_name <span class="op">=</span> <span class="st">"pep_imputed_nonparam"</span>,
                                   toscale <span class="op">=</span> <span class="cn">NULL</span>,
                                   benchmark <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sc <span class="op">=</span> <span class="st">"estimate"</span>, desc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sc <span class="op">=</span> <span class="st">"statistic"</span>, desc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
                                   <span class="op">)</span>,
                                   FDRvsFDP <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">plot_score_distribution</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmarkImputation-1.png" width="960"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">plot_ROC</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmarkImputation-2.png" width="960"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">medpol_benchmark</span><span class="op">$</span><span class="fu">pAUC_summaries</span><span class="op">(</span><span class="op">)</span>
<span class="va">x</span><span class="op">$</span><span class="va">barp</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/benchmarkImputation-3.png" width="960"></p>
</div>
<div id="compare-fold-changes-for-both-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#compare-fold-changes-for-both-methods" class="anchor"></a>Compare fold changes for both methods</h1>
<p>Plot scatter plots for fold changes obtained using the linear model and missing value imputation.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cs</span> <span class="op">&lt;-</span> <span class="va">cs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">protein_Id</span>, est_imp <span class="op">=</span> <span class="va">estimate</span>   <span class="op">)</span>
<span class="va">contrdf</span> <span class="op">&lt;-</span> <span class="va">contrdf</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="va">protein_Id</span>, est_lm <span class="op">=</span> <span class="va">estimate</span> <span class="op">)</span>
<span class="va">estimates_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">contrdf</span>, <span class="va">cs</span><span class="op">)</span>

<span class="va">estimates_compare</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">est_lm</span>, y <span class="op">=</span> <span class="va">est_imp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="BenchmarkingIonstarData_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
