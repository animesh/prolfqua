<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing Two Groups • prolfqua</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparing Two Groups">
<meta property="og:description" content="prolfqua">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prolfqua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing2Groups.html">Comparing Two Groups</a>
    </li>
    <li>
      <a href="../articles/CreatingConfigurations.html">Creating prolfqua Configurations</a>
    </li>
    <li>
      <a href="../articles/ModelWithInteractions.html">Modelling with Interactions.</a>
    </li>
    <li>
      <a href="../articles/Modelling2Factors.html">Modelling Dataset with two Factors.</a>
    </li>
    <li>
      <a href="../articles/QCandSampleSize.html">Quality Control &amp; Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/QualityControlAndSampleSizeEstimation.html">QC and Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_HL_Skyline.html">Supplement - Data preprocessing of SRM Heavy Light data</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_Skyline_PRM.html">Supplement - Data preprocessing for PRM</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyCorrelationAnalysis.html">Supplement - Filter precursors or fragments based on correlation</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary.html">Supplement - Summarize SRM Peptide Level Measurements</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary_HL.html">Supplement - Summarize heavy light Peptide Level Measurements</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolski/prolfqua/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Comparing2Groups_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="Comparing2Groups_files/plotly-binding-4.10.0/plotly.js"></script><script src="Comparing2Groups_files/typedarray-0.1/typedarray.min.js"></script><link href="Comparing2Groups_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="Comparing2Groups_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="Comparing2Groups_files/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Comparing2Groups_files/plotly-main-2.5.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Comparing Two Groups</h1>
                        <h4 data-toc-skip class="author">Witold
Wolski</h4>
            
            <h4 data-toc-skip class="date">23 June, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolski/prolfqua/blob/HEAD/../vignettes/Comparing2Groups.Rmd" class="external-link"><code>../vignettes/Comparing2Groups.Rmd</code></a></small>
      <div class="hidden name"><code>Comparing2Groups.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="loading-protein-abundances-from-maxquant-proteingroups-txt">Loading protein abundances from MaxQuant proteinGroups.txt<a class="anchor" aria-label="anchor" href="#loading-protein-abundances-from-maxquant-proteingroups-txt"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wolski/prolfqua" class="external-link">prolfqua</a></span><span class="op">)</span></code></pre></div>
<p>Specify the path to the MaxQuant <code>proteinGroups.txt</code> file.
The function <code>tidyMQ_ProteinGroups</code> will read the
<code>proteinGroups.txt</code> file and convert it into a tidy table</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datadir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"prolfqua"</span><span class="op">)</span> , <span class="st">"samples/maxquant_txt"</span><span class="op">)</span>
<span class="va">inputMQfile</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"tiny2.zip"</span><span class="op">)</span>
<span class="va">inputAnnotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"annotation_Ionstar2018_PXD003881.xlsx"</span><span class="op">)</span>
<span class="va">startdata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/tidyMQ_ProteinGroups.html">tidyMQ_ProteinGroups</a></span><span class="op">(</span><span class="va">inputMQfile</span><span class="op">)</span></code></pre></div>
<p>Read the sample annotation. The sample annotation must contain the
<code>raw.file</code> name and the explanatory variables of your
experiment, e.g. treatment, timepoint, genetic background, or other
factors which you would like to check for confounding.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">inputAnnotation</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="co">##   raw.file                                                   run_ID date  sample</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> b03_02_150304_human_ecoli_b_3ul_3um_column_95_hcd_ot_2hrs… 02     1503… b     </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> b03_03_150304_human_ecoli_c_3ul_3um_column_95_hcd_ot_2hrs… 03     1503… c     </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> b03_04_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2hrs… 04     1503… d     </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> b03_05_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2hrs… 05     1503… e     </span>
<span class="co">## <span style="color: #BCBCBC;">5</span> b03_06_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2hrs… 06     1503… e     </span>
<span class="co">## <span style="color: #BCBCBC;">6</span> b03_07_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2hrs… 07     1503… d</span></code></pre>
<p>Merge the annotation with quantitative data using
<code>inner_join</code> joining by <code>raw.file</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">annotation</span>, <span class="va">startdata</span>, by <span class="op">=</span> <span class="st">"raw.file"</span><span class="op">)</span></code></pre></div>
<p>We remove all proteins identified only by a single peptide.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">startdata</span>, <span class="va">nr.peptides</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Then you need to <em>tell</em> <code>prolfqua</code> which columns in
the data frame contain what information. You do it using the
<code>AnalysisTableAnnotation</code> class.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atable</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AnalysisTableAnnotation.html">AnalysisTableAnnotation</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The <code>AnalysisTableAnnotation</code> has the following fields
that need to be populated:</p>
<ul>
<li>fileName</li>
<li>hierarchy</li>
<li>factors</li>
<li>workingIntensity</li>
</ul>
<p>, and we will discuss in more detail next.</p>
<p>The <code>fileName</code> is the column with the raw file names,
however for labelled TMT experiments, it can be used to hold the name of
the TMT channel.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atable</span><span class="op">$</span><span class="va">fileName</span> <span class="op">=</span> <span class="st">"raw.file"</span></code></pre></div>
<p>The <code>hierarchy</code> field describes the structure of the MS
data e.g,</p>
<ul>
<li>protein</li>
<li>peptides</li>
<li>modified peptides</li>
<li>precursor</li>
</ul>
<p>In case of the MQ proteinGroups file we have data on protein
level.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atable</span><span class="op">$</span><span class="va">hierarchy</span><span class="op">[[</span><span class="st">"protein_Id"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proteinID"</span><span class="op">)</span></code></pre></div>
<p>In addition you need to describe the <code>factors</code> of the
analysis, i.e, the column containing the explanatory variables. By
setting the <code>factorDepth</code> variable to <span class="math inline">\(1\)</span> we include only the “dilution.”
variable into the modelling.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atable</span><span class="op">$</span><span class="va">factors</span><span class="op">[[</span><span class="st">"dilution."</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="st">"sample"</span></code></pre></div>
<p>We also need to specify the column containing the protein
abundances.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atable</span><span class="op">$</span><span class="fu">setWorkIntensity</span><span class="op">(</span><span class="st">"mq.protein.intensity"</span><span class="op">)</span></code></pre></div>
<p>Finally we create the <code>AnalysisConfiguration</code> which needs
the <code>AnalysisTableAnnotation</code> we just created and the
<code>AnalysisParameters</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">config</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AnalysisConfiguration.html">AnalysisConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">atable</span><span class="op">)</span>
<span class="va">adata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_analysis.html">setup_analysis</a></span><span class="op">(</span><span class="va">startdata</span>, <span class="va">config</span><span class="op">)</span></code></pre></div>
<p>Create the <code>LFQData</code> class instance and remove zeros from
data (MaxQuant encodes missing values with zero).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqdata</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">adata</span>, <span class="va">config</span><span class="op">)</span>
<span class="va">lfqdata</span><span class="op">$</span><span class="fu">remove_small_intensities</span><span class="op">(</span><span class="op">)</span>
<span class="va">lfqdata</span><span class="op">$</span><span class="fu">factors</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 20 × 3</span></span>
<span class="co">##    raw.file                                                 sampleName dilution.</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> b03_10_150304_human_ecoli_a_3ul_3um_column_95_hcd_ot_2h… a          a        </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> b03_11_150304_human_ecoli_a_3ul_3um_column_95_hcd_ot_2h… a~1        a        </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> b03_20_150304_human_ecoli_a_3ul_3um_column_95_hcd_ot_2h… a~2        a        </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> b03_21_150304_human_ecoli_a_3ul_3um_column_95_hcd_ot_2h… a~3        a        </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> b03_02_150304_human_ecoli_b_3ul_3um_column_95_hcd_ot_2h… b          b        </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> b03_09_150304_human_ecoli_b_3ul_3um_column_95_hcd_ot_2h… b~1        b        </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> b03_12_150304_human_ecoli_b_3ul_3um_column_95_hcd_ot_2h… b~2        b        </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> b03_19_150304_human_ecoli_b_3ul_3um_column_95_hcd_ot_2h… b~3        b        </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> b03_03_150304_human_ecoli_c_3ul_3um_column_95_hcd_ot_2h… c          c        </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> b03_08_150304_human_ecoli_c_3ul_3um_column_95_hcd_ot_2h… c~1        c        </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> b03_13_150304_human_ecoli_c_3ul_3um_column_95_hcd_ot_2h… c~2        c        </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> b03_18_150304_human_ecoli_c_3ul_3um_column_95_hcd_ot_2h… c~3        c        </span>
<span class="co">## <span style="color: #BCBCBC;">13</span> b03_04_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2h… d          d        </span>
<span class="co">## <span style="color: #BCBCBC;">14</span> b03_07_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2h… d~1        d        </span>
<span class="co">## <span style="color: #BCBCBC;">15</span> b03_14_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2h… d~2        d        </span>
<span class="co">## <span style="color: #BCBCBC;">16</span> b03_17_150304_human_ecoli_d_3ul_3um_column_95_hcd_ot_2h… d~3        d        </span>
<span class="co">## <span style="color: #BCBCBC;">17</span> b03_05_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2h… e          e        </span>
<span class="co">## <span style="color: #BCBCBC;">18</span> b03_06_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2h… e~1        e        </span>
<span class="co">## <span style="color: #BCBCBC;">19</span> b03_15_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2h… e~2        e        </span>
<span class="co">## <span style="color: #BCBCBC;">20</span> b03_16_150304_human_ecoli_e_3ul_3um_column_95_hcd_ot_2h… e~3        e</span></code></pre>
<p>You can convert the data into wide format.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqdata</span><span class="op">$</span><span class="fu">to_wide</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">##   protein_Id                   a    `a~1`</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> CON__P02668           20<span style="text-decoration: underline;">452</span>000 25<span style="text-decoration: underline;">329</span>000</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> sp|O00401|WASL_HUMAN  49<span style="text-decoration: underline;">876</span>000 78<span style="text-decoration: underline;">810</span>000</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> sp|O14683|P5I11_HUMAN 45<span style="text-decoration: underline;">303</span>000 17<span style="text-decoration: underline;">463</span>000</span></code></pre>
<div class="section level3">
<h3 id="visualization-of-not-normalized-data">Visualization of not normalized data<a class="anchor" aria-label="anchor" href="#visualization-of-not-normalized-data"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqplotter</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">density_nn</span> <span class="op">&lt;-</span> <span class="va">lfqplotter</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="visualization-of-missing-data">Visualization of missing data<a class="anchor" aria-label="anchor" href="#visualization-of-missing-data"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Summariser</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">plot_missingness_per_group</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/missignessPerGroup-1.png" alt="# of proteins with 0,1,...N missing values" width="700"><p class="caption">
# of proteins with 0,1,…N missing values
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfqplotter</span><span class="op">$</span><span class="fu">missigness_histogram</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/missignessHistogram-1.png" alt="Intensity distribution of proteins depending on # of missing values" width="700"><p class="caption">
Intensity distribution of proteins depending on # of missing values
</p>
</div>
</div>
<div class="section level4">
<h4 id="computing-standard-deviations-mean-and-cv-">Computing standard deviations, mean and CV.<a class="anchor" aria-label="anchor" href="#computing-standard-deviations-mean-and-cv-"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span>
<span class="va">stats</span><span class="op">$</span><span class="fu">violin</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Comparing2Groups_files/figure-html/PlotCVDistributions-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stats_quantiles</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">wide</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"quantile of "</span>,<span class="va">stats</span><span class="op">$</span><span class="va">stat</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>quantile of CV</caption>
<thead><tr class="header">
<th align="right">probs</th>
<th align="right">a</th>
<th align="right">All</th>
<th align="right">b</th>
<th align="right">c</th>
<th align="right">d</th>
<th align="right">e</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">9.993088</td>
<td align="right">13.45674</td>
<td align="right">9.50443</td>
<td align="right">10.50083</td>
<td align="right">9.816257</td>
<td align="right">11.81279</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">12.742718</td>
<td align="right">17.27817</td>
<td align="right">12.21082</td>
<td align="right">14.46669</td>
<td align="right">12.060028</td>
<td align="right">14.45046</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">20.783568</td>
<td align="right">24.99997</td>
<td align="right">19.28001</td>
<td align="right">18.95460</td>
<td align="right">18.908048</td>
<td align="right">22.08057</td>
</tr>
<tr class="even">
<td align="right">0.75</td>
<td align="right">29.616325</td>
<td align="right">34.46159</td>
<td align="right">29.02860</td>
<td align="right">27.98157</td>
<td align="right">31.380660</td>
<td align="right">32.88253</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">42.777323</td>
<td align="right">49.18627</td>
<td align="right">37.57644</td>
<td align="right">40.90806</td>
<td align="right">42.644015</td>
<td align="right">47.61966</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stats</span><span class="op">$</span><span class="fu">density_median</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/plotCVsplitbyMedianIntensity-1.png" alt="Distribution of CV's for top 50% and bottom 50% proteins by intensity." width="700"><p class="caption">
Distribution of CV’s for top 50% and bottom 50% proteins by intensity.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="normalize-protein-intensities">Normalize protein intensities<a class="anchor" aria-label="anchor" href="#normalize-protein-intensities"></a>
</h3>
<p>We normalize the data by <span class="math inline">\(\log_2\)</span>
transforming and then <span class="math inline">\(z-scaling\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lt</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Transformer</span><span class="op">(</span><span class="op">)</span>
<span class="va">transformed</span> <span class="op">&lt;-</span> <span class="va">lt</span><span class="op">$</span><span class="fu">log2</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">robscale</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lfq</span>
<span class="va">transformed</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">is_intensity_transformed</span></code></pre></div>
<pre><code><span class="co">## [1] TRUE</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">density_norm</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">density_nn</span>, <span class="va">density_norm</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/showIntensityDistributions-1.png" alt="Distribution of intensities before and aftern normalization." width="700"><p class="caption">
Distribution of intensities before and aftern normalization.
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span><span class="op">$</span><span class="fu">pairs_smooth</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/plotScatterMatrix-1.png" alt="Scatterplot matrix" width="700"><p class="caption">
Scatterplot matrix
</p>
</div>
<pre><code><span class="co">## NULL</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">heatmap_cor</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: 5">
<img src="Comparing2Groups_files/figure-html/plotheatmap-1.png" alt="Heatmap, Rows - proteins, Columns - samples" width="700"><p class="caption">
Heatmap, Rows - proteins, Columns - samples
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-a-linear-model">Fitting a linear model<a class="anchor" aria-label="anchor" href="#fitting-a-linear-model"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">transformed</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">getWorkIntensity</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "transformedIntensity"</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula_Condition</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/strategy.html">strategy_lm</a></span><span class="op">(</span><span class="st">"transformedIntensity ~ dilution."</span><span class="op">)</span>

<span class="co"># specify model definition</span>
<span class="va">modelName</span>  <span class="op">&lt;-</span> <span class="st">"Model"</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">transformed</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">dilution.</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "b" "c" "d" "e" "a"</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dila - dilb"</span> <span class="op">=</span> <span class="st">"dilution.a - dilution.b"</span>,
<span class="st">"AvsC"</span> <span class="op">=</span> <span class="st">"dilution.a - dilution.c"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/build_model.html">build_model</a></span><span class="op">(</span>
  <span class="va">transformed</span><span class="op">$</span><span class="va">data</span>,
  <span class="va">formula_Condition</span>,
  subject_Id <span class="op">=</span> <span class="va">transformed</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">hierarchyKeys</span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span><span class="op">$</span><span class="fu">anova_histogram</span><span class="op">(</span><span class="st">"FDR.Pr..F."</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $plot</span></code></pre>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/showANOVA-1.png" alt="Distribtuion of " width="700"><p class="caption">
Distribtuion of
</p>
</div>
<pre><code><span class="co">## </span>
<span class="co">## $name</span>
<span class="co">## [1] "Anova_p.values_Model.pdf"</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aovtable</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">get_anova</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">aovtable</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="co">##   protein_Id       isSingular nrcoef factor    Df  Sum.Sq Mean.Sq F.value Pr..F.</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> CON__P02668      FALSE           5 dilut…     4 0.181   4.52<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 0.488    0.744</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> sp|O00401|WASL_… FALSE           5 dilut…     4 0.345   8.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 0.816    0.535</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> sp|O14683|P5I11… FALSE           5 dilut…     4 0.751   1.88<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 0.435    0.782</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> sp|O43251|RFOX2… FALSE           5 dilut…     4 1.02    2.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 1.15     0.370</span>
<span class="co">## <span style="color: #BCBCBC;">5</span> sp|O43395|PRPF3… FALSE           5 dilut…     4 0.260   6.49<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 0.556    0.698</span>
<span class="co">## <span style="color: #BCBCBC;">6</span> sp|O75962|TRIO_… FALSE           5 dilut…     4 0.002<span style="text-decoration: underline;">80</span> 7.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.004<span style="text-decoration: underline;">24</span>  1.00 </span>
<span class="co">## <span style="color: #949494;"># … with 1 more variable: FDR.Pr..F. &lt;dbl&gt;</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">aovtable</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 86 10</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">aovtable</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">FDR.Pr..F.</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">signif</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span>
<span class="va">signif</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">signif</span><span class="op">$</span><span class="va">data</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein_Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">xx</span><span class="op">$</span><span class="va">protein_Id</span><span class="op">)</span>
<span class="va">hmSig</span> <span class="op">&lt;-</span> <span class="va">signif</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">heatmap</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmSig</span></code></pre></div>
<p><img src="Comparing2Groups_files/figure-html/showSigHeatmap-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="compute-contrasts">Compute contrasts<a class="anchor" aria-label="anchor" href="#compute-contrasts"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/Contrasts.html">Contrasts</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, <span class="va">Contrasts</span><span class="op">)</span>
<span class="va">v1</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Moderate the variance and using the Experimental Bayes method
implmented in <code>ContrastsModerated</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/ContrastsModerated.html">ContrastsModerated</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">contr</span><span class="op">)</span>
<span class="co">#contr$get_contrasts_sides()</span>
<span class="va">contrdf</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span>
<span class="co">#View(contrdf)</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plotter</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">v2</span> <span class="op">&lt;-</span> <span class="va">plotter</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span>
<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">v1</span><span class="op">$</span><span class="va">FDR</span>,<span class="va">v2</span><span class="op">$</span><span class="va">FDR</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="Comparing2Groups_files/figure-html/plotVolcanos-1.png" alt="Volcano plot, Left panel - no moderation, Right panel - with moderation." width="700"><p class="caption">
Volcano plot, Left panel - no moderation, Right panel - with moderation.
</p>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plotter</span><span class="op">$</span><span class="fu">ma_plotly</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<div id="htmlwidget-f559946ed25b69543d8d" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f559946ed25b69543d8d">{"x":{"data":[{"x":[24.2799950073031,25.6024911533777,25.3116896148771,24.7042258650085,26.3459128461377,26.7687245962195,26.6069343608859,22.9922839649892,33.0367788088694,28.6371406070874,21.3002034879475,23.2696259638573,29.6564350447375,28.1784580518524,27.2651893870562,24.3589374865592,26.42385502446,27.0397573698233,22.32844870551,26.8855875056964,24.2336182579218,22.6199473982199,27.2169487673189,24.7387561589062,24.4057971684207,29.00920572533,27.713237147104,26.2202696907836,23.8665454479744,25.6335445054425,25.9336250792781,25.5057295044664,26.8449146666289,22.8355788427354,25.8485426776931,28.198716998187,26.3363136384971,25.9427281570439,25.2638044919031,33.8419079646197,23.5189703755624,22.7931838401938,24.3851167018201,23.641113382088,24.6636593904847,23.9484833757974,23.9849027178012,24.3473017111539,21.7596357094325,25.2369426371834,28.1291630970476,30.1191039628534,22.7926825259004,26.4490596859822,25.9228410830212,27.1723312677253,29.9109631558397,24.8590157315984,26.7056173274475,23.9389410298772,24.9012004861264,25.3117913930445,22.3024697536353,25.8037933736952,27.1998383191436,27.6403866433836,23.1812264769949,27.2041190965487,26.6478980612984,25.7190983365382,26.9082124977417,25.5618389693003,24.0910341279728,28.9792213286873,22.8872494953578,23.5727505033908,24.8093065653677,29.3351609119992,30.2294463827036,24.1707175377916,22.2632919779384,26.2786699850639,21.9264214628881,21.9701988242935,22.2627179701004,23.4835092385026],"y":[-0.0370087700058699,0.0381427400290536,-0.499185088070681,-0.413346737533993,-0.0789308459297963,-0.0103151551842658,-0.094359347734554,-0.445008032401736,-0.635645840271041,-1.01150415242144,-2.74127239131267,-1.21285367033011,0.240239639774955,0.0750421992516478,-1.2463282099558,-0.57034103348436,-1.37146062475463,-1.24908168556032,0.71820518455152,0.102269169252017,-0.174776065089512,-0.467695857612241,0.227894596795799,-0.116209863661199,-1.86368725860537,0.163757094204495,-0.0283994425930365,-0.157701592208655,0.0958022184070267,0.0435357353485859,-0.0796837291733903,0.3572177217044,0.131535839317425,-0.514163426941896,0.185209001862483,0.195171027877542,-0.141573174361341,-0.00467158943347476,0.021391973159191,0.484186204868205,-0.457053320441293,-1.19151483285267,-0.15086498746505,-0.652308124169345,-0.667872584701096,0.251855555308362,0.48086755733134,0.0799044535623443,0.692541856938149,-0.504957020940395,0.123504503519521,0.264753534725763,-0.729504741483904,-0.102841911864974,-0.0430169189154945,0.0405229039783001,0.26286644780788,0.035945000706097,-0.242027684950652,-0.701506613631386,-0.0157745771788836,-0.267135563341726,0.475947004025473,-0.289950972470542,-0.131234813572385,0.144323458149987,-0.210618384652679,0.21852107508199,-0.132191678063985,-0.11194812386846,0.0831320598570961,-0.0365193973379565,-0.183903922911623,0.165639595347796,-0.171322883731661,-0.596901620203218,-0.0624660255876666,0.230219802262239,0.132703554280923,-0.0581906772458158,-0.81527378587718,0.0570941552944592,-2.07158796927438,-0.446848082878626,0.574335887459173,0.00450320623664139],"text":["CON__P02668","sp|O00401|WASL_HUMAN","sp|O14683|P5I11_HUMAN","sp|O43251|RFOX2_HUMAN","sp|O43395|PRPF3_HUMAN","sp|O75962|TRIO_HUMAN","sp|O95573|ACSL3_HUMAN","sp|O95785|WIZ_HUMAN","sp|P02925|RBSB_ECOLI","sp|P02931|OMPF_ECOLI","sp|P07639|AROB_ECOLI","sp|P07650|TYPH_ECOLI","sp|P08195|4F2_HUMAN","sp|P08574|CY1_HUMAN","sp|P0A805|RRF_ECOLI","sp|P0A8N3|SYK1_ECOLI","sp|P0AC33|FUMA_ECOLI","sp|P0AG51|RL30_ECOLI","sp|P0AGG2|TESB_ECOLI","sp|P16144|ITB4_HUMAN","sp|P19387|RPB3_HUMAN","sp|P20839|IMDH1_HUMAN","sp|P21926|CD9_HUMAN","sp|P28340|DPOD1_HUMAN","sp|P28635|METQ_ECOLI","sp|P48444|COPD_HUMAN","sp|P50579|MAP2_HUMAN","sp|P52434|RPAB3_HUMAN","sp|P54760|EPHB4_HUMAN","sp|P61024|CKS1_HUMAN","sp|P61457|PHS_HUMAN","sp|P80303|NUCB2_HUMAN","sp|P82650|RT22_HUMAN","sp|Q05932|FOLC_HUMAN","sp|Q08380|LG3BP_HUMAN","sp|Q12874|SF3A3_HUMAN","sp|Q14696|MESD_HUMAN","sp|Q14C86|GAPD1_HUMAN","sp|Q15018|ABRX2_HUMAN","sp|Q15149|PLEC_HUMAN","sp|Q15172|2A5A_HUMAN","sp|Q16512|PKN1_HUMAN","sp|Q5TDH0|DDI2_HUMAN","sp|Q6NYC1|JMJD6_HUMAN","sp|Q86SQ4|AGRG6_HUMAN","sp|Q86U90|YRDC_HUMAN","sp|Q8N4L2|PP4P2_HUMAN","sp|Q8NBL1|PGLT1_HUMAN","sp|Q8ND04|SMG8_HUMAN","sp|Q8TC07|TBC15_HUMAN","sp|Q8WWM7|ATX2L_HUMAN","sp|Q92598|HS105_HUMAN","sp|Q92896|GSLG1_HUMAN","sp|Q93052|LPP_HUMAN","sp|Q96A49|SYAP1_HUMAN","sp|Q96A72|MGN2_HUMAN","sp|Q96AG4|LRC59_HUMAN","sp|Q96K37|S35E1_HUMAN","sp|Q99816|TS101_HUMAN","sp|Q99836|MYD88_HUMAN","sp|Q9BV86|NTM1A_HUMAN","sp|Q9BW83|IFT27_HUMAN","sp|Q9C0B1|FTO_HUMAN","sp|Q9H0U3|MAGT1_HUMAN","sp|Q9H307|PININ_HUMAN","sp|Q9H773|DCTP1_HUMAN","sp|Q9H9Y6|RPA2_HUMAN","sp|Q9NP72|RAB18_HUMAN","sp|Q9NR45|SIAS_HUMAN","sp|Q9NUQ8|ABCF3_HUMAN","sp|Q9NX40|OCAD1_HUMAN","sp|Q9NX58|LYAR_HUMAN","sp|Q9UBI1|COMD3_HUMAN","sp|Q9UHD1|CHRD1_HUMAN","sp|Q9UJ83|HACL1_HUMAN","sp|Q9UJX3|APC7_HUMAN","sp|Q9UKZ1|CNO11_HUMAN","sp|Q9UL46|PSME2_HUMAN","sp|Q9Y262|EIF3L_HUMAN","sp|Q9Y3Y2|CHTOP_HUMAN","sp|Q9Y5N5|N6MT1_HUMAN","sp|Q9Y6A5|TACC3_HUMAN","sp|P04846|NLPA_ECOLI","sp|Q13415|ORC1_HUMAN","sp|Q12933|TRAF2_HUMAN","sp|Q6R327|RICTR_HUMAN"],"key":["CON__P02668","sp|O00401|WASL_HUMAN","sp|O14683|P5I11_HUMAN","sp|O43251|RFOX2_HUMAN","sp|O43395|PRPF3_HUMAN","sp|O75962|TRIO_HUMAN","sp|O95573|ACSL3_HUMAN","sp|O95785|WIZ_HUMAN","sp|P02925|RBSB_ECOLI","sp|P02931|OMPF_ECOLI","sp|P07639|AROB_ECOLI","sp|P07650|TYPH_ECOLI","sp|P08195|4F2_HUMAN","sp|P08574|CY1_HUMAN","sp|P0A805|RRF_ECOLI","sp|P0A8N3|SYK1_ECOLI","sp|P0AC33|FUMA_ECOLI","sp|P0AG51|RL30_ECOLI","sp|P0AGG2|TESB_ECOLI","sp|P16144|ITB4_HUMAN","sp|P19387|RPB3_HUMAN","sp|P20839|IMDH1_HUMAN","sp|P21926|CD9_HUMAN","sp|P28340|DPOD1_HUMAN","sp|P28635|METQ_ECOLI","sp|P48444|COPD_HUMAN","sp|P50579|MAP2_HUMAN","sp|P52434|RPAB3_HUMAN","sp|P54760|EPHB4_HUMAN","sp|P61024|CKS1_HUMAN","sp|P61457|PHS_HUMAN","sp|P80303|NUCB2_HUMAN","sp|P82650|RT22_HUMAN","sp|Q05932|FOLC_HUMAN","sp|Q08380|LG3BP_HUMAN","sp|Q12874|SF3A3_HUMAN","sp|Q14696|MESD_HUMAN","sp|Q14C86|GAPD1_HUMAN","sp|Q15018|ABRX2_HUMAN","sp|Q15149|PLEC_HUMAN","sp|Q15172|2A5A_HUMAN","sp|Q16512|PKN1_HUMAN","sp|Q5TDH0|DDI2_HUMAN","sp|Q6NYC1|JMJD6_HUMAN","sp|Q86SQ4|AGRG6_HUMAN","sp|Q86U90|YRDC_HUMAN","sp|Q8N4L2|PP4P2_HUMAN","sp|Q8NBL1|PGLT1_HUMAN","sp|Q8ND04|SMG8_HUMAN","sp|Q8TC07|TBC15_HUMAN","sp|Q8WWM7|ATX2L_HUMAN","sp|Q92598|HS105_HUMAN","sp|Q92896|GSLG1_HUMAN","sp|Q93052|LPP_HUMAN","sp|Q96A49|SYAP1_HUMAN","sp|Q96A72|MGN2_HUMAN","sp|Q96AG4|LRC59_HUMAN","sp|Q96K37|S35E1_HUMAN","sp|Q99816|TS101_HUMAN","sp|Q99836|MYD88_HUMAN","sp|Q9BV86|NTM1A_HUMAN","sp|Q9BW83|IFT27_HUMAN","sp|Q9C0B1|FTO_HUMAN","sp|Q9H0U3|MAGT1_HUMAN","sp|Q9H307|PININ_HUMAN","sp|Q9H773|DCTP1_HUMAN","sp|Q9H9Y6|RPA2_HUMAN","sp|Q9NP72|RAB18_HUMAN","sp|Q9NR45|SIAS_HUMAN","sp|Q9NUQ8|ABCF3_HUMAN","sp|Q9NX40|OCAD1_HUMAN","sp|Q9NX58|LYAR_HUMAN","sp|Q9UBI1|COMD3_HUMAN","sp|Q9UHD1|CHRD1_HUMAN","sp|Q9UJ83|HACL1_HUMAN","sp|Q9UJX3|APC7_HUMAN","sp|Q9UKZ1|CNO11_HUMAN","sp|Q9UL46|PSME2_HUMAN","sp|Q9Y262|EIF3L_HUMAN","sp|Q9Y3Y2|CHTOP_HUMAN","sp|Q9Y5N5|N6MT1_HUMAN","sp|Q9Y6A5|TACC3_HUMAN","sp|P04846|NLPA_ECOLI","sp|Q13415|ORC1_HUMAN","sp|Q12933|TRAF2_HUMAN","sp|Q6R327|RICTR_HUMAN"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","set":"SharedData987c1d8b","name":"WaldTest_moderated","legendgroup":"WaldTest_moderated","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[24.3981654272141,25.7168450694514,25.0532600791512,24.6212284799798,26.4587463422062,26.7670276111417,26.6073496184772,22.7434538068925,33.0117812040392,28.5233387872242,20.4054776112028,22.5353249261038,29.7600723538305,28.2500307899332,27.1020037140572,24.1087668264059,26.2027459400842,26.756585063649,22.6355644721137,26.9378672215277,24.1607610879566,22.4494281277731,27.3024852984523,24.6638466949719,24.296566275686,29.1086357894742,27.7548025527262,26.2038192652034,23.9355991288562,25.7411872916239,25.9140371054602,25.7638139098708,26.7967187257251,22.7866888083079,26.0083559079673,28.3432517790328,26.306923196327,25.8805487117592,25.2955358650693,34.0267286814384,23.3024410319728,22.6222141063913,24.4765018821009,23.7137263485132,24.4600142642355,24.1863144714108,24.1238778273173,24.4167669178716,22.3461698397305,25.1515088314269,28.1941583630034,30.2793336254769,22.8457534013594,26.463885348989,25.9759106560675,27.1430556654296,29.9699346046532,24.9534116309196,26.7185729943939,23.6878862302999,24.9265146502525,25.3044228383916,22.6976658652975,25.7515602122679,27.1210296349901,27.6488819745215,23.0186512426336,27.3509037071352,26.7009401783067,25.6526232708866,27.0106672949383,25.5171545338489,24.0408473440869,29.0397523556569,22.7743530691205,23.4555217821401,24.7139820505879,29.4294217623803,30.3016955639018,24.1298225004365,22.1517534485065,26.2620528908299,21.1877126860359,21.8311568439576,22.0809880552028,23.3085319429857],"y":[-0.273349609827885,-0.1905650921183,0.0176739833812406,-0.247351967476556,-0.304597838066796,-0.00692118502863726,-0.0951898629171884,0.0526522837917464,-0.585650630610746,-0.783900512695067,-0.951820637823278,0.255748405177049,0.0329650215890158,-0.0681032769099409,-0.919956863957651,-0.0699997131776291,-0.929242456003071,-0.682737073211805,0.103973651344212,-0.00229026241067526,-0.0290617251592606,-0.126657316718651,0.05682153452913,0.0336090642072704,-1.64522547313591,-0.035103034083865,-0.111530253837436,-0.124800741048242,-0.0423051433565466,-0.171749837014142,-0.0405077815376891,-0.15895108910437,0.227927721124884,-0.416383358086873,-0.134417458685978,-0.0938985338138728,-0.0827922900211621,0.119687301136048,-0.0420707731731661,0.114544771230822,-0.0239946332620904,-0.849575365247593,-0.333635348026654,-0.797534057019556,-0.260582332202624,-0.223806635918502,0.202917338299239,-0.0590259598730986,-0.480526403657902,-0.334089409427354,-0.0064860283919676,-0.0557057905211487,-0.83564649240195,-0.132493237878612,-0.149156065008109,0.0990741085696158,0.144923550180849,-0.152846797936307,-0.26793901884341,-0.199397014476877,-0.0664029054311435,-0.252398454036055,-0.314445219298971,-0.185484649615879,0.0263825547346568,0.127332795874144,0.114532084070064,-0.0750481460908944,-0.238275912080667,0.021002007434818,-0.121777534535982,0.0528494735650022,-0.0835303551397922,0.0445775414085877,0.0544699687429123,-0.36244417770176,0.128183003971897,0.0416981015000355,-0.0117948081153414,0.023599397464457,-0.592196727013424,0.0903283437624291,-0.594170415569969,-0.168764122206703,0.937795717254288,0.3544577972704],"text":["CON__P02668","sp|O00401|WASL_HUMAN","sp|O14683|P5I11_HUMAN","sp|O43251|RFOX2_HUMAN","sp|O43395|PRPF3_HUMAN","sp|O75962|TRIO_HUMAN","sp|O95573|ACSL3_HUMAN","sp|O95785|WIZ_HUMAN","sp|P02925|RBSB_ECOLI","sp|P02931|OMPF_ECOLI","sp|P07639|AROB_ECOLI","sp|P07650|TYPH_ECOLI","sp|P08195|4F2_HUMAN","sp|P08574|CY1_HUMAN","sp|P0A805|RRF_ECOLI","sp|P0A8N3|SYK1_ECOLI","sp|P0AC33|FUMA_ECOLI","sp|P0AG51|RL30_ECOLI","sp|P0AGG2|TESB_ECOLI","sp|P16144|ITB4_HUMAN","sp|P19387|RPB3_HUMAN","sp|P20839|IMDH1_HUMAN","sp|P21926|CD9_HUMAN","sp|P28340|DPOD1_HUMAN","sp|P28635|METQ_ECOLI","sp|P48444|COPD_HUMAN","sp|P50579|MAP2_HUMAN","sp|P52434|RPAB3_HUMAN","sp|P54760|EPHB4_HUMAN","sp|P61024|CKS1_HUMAN","sp|P61457|PHS_HUMAN","sp|P80303|NUCB2_HUMAN","sp|P82650|RT22_HUMAN","sp|Q05932|FOLC_HUMAN","sp|Q08380|LG3BP_HUMAN","sp|Q12874|SF3A3_HUMAN","sp|Q14696|MESD_HUMAN","sp|Q14C86|GAPD1_HUMAN","sp|Q15018|ABRX2_HUMAN","sp|Q15149|PLEC_HUMAN","sp|Q15172|2A5A_HUMAN","sp|Q16512|PKN1_HUMAN","sp|Q5TDH0|DDI2_HUMAN","sp|Q6NYC1|JMJD6_HUMAN","sp|Q86SQ4|AGRG6_HUMAN","sp|Q86U90|YRDC_HUMAN","sp|Q8N4L2|PP4P2_HUMAN","sp|Q8NBL1|PGLT1_HUMAN","sp|Q8ND04|SMG8_HUMAN","sp|Q8TC07|TBC15_HUMAN","sp|Q8WWM7|ATX2L_HUMAN","sp|Q92598|HS105_HUMAN","sp|Q92896|GSLG1_HUMAN","sp|Q93052|LPP_HUMAN","sp|Q96A49|SYAP1_HUMAN","sp|Q96A72|MGN2_HUMAN","sp|Q96AG4|LRC59_HUMAN","sp|Q96K37|S35E1_HUMAN","sp|Q99816|TS101_HUMAN","sp|Q99836|MYD88_HUMAN","sp|Q9BV86|NTM1A_HUMAN","sp|Q9BW83|IFT27_HUMAN","sp|Q9C0B1|FTO_HUMAN","sp|Q9H0U3|MAGT1_HUMAN","sp|Q9H307|PININ_HUMAN","sp|Q9H773|DCTP1_HUMAN","sp|Q9H9Y6|RPA2_HUMAN","sp|Q9NP72|RAB18_HUMAN","sp|Q9NR45|SIAS_HUMAN","sp|Q9NUQ8|ABCF3_HUMAN","sp|Q9NX40|OCAD1_HUMAN","sp|Q9NX58|LYAR_HUMAN","sp|Q9UBI1|COMD3_HUMAN","sp|Q9UHD1|CHRD1_HUMAN","sp|Q9UJ83|HACL1_HUMAN","sp|Q9UJX3|APC7_HUMAN","sp|Q9UKZ1|CNO11_HUMAN","sp|Q9UL46|PSME2_HUMAN","sp|Q9Y262|EIF3L_HUMAN","sp|Q9Y3Y2|CHTOP_HUMAN","sp|Q9Y5N5|N6MT1_HUMAN","sp|Q9Y6A5|TACC3_HUMAN","sp|P04846|NLPA_ECOLI","sp|Q13415|ORC1_HUMAN","sp|Q12933|TRAF2_HUMAN","sp|Q6R327|RICTR_HUMAN"],"key":["CON__P02668","sp|O00401|WASL_HUMAN","sp|O14683|P5I11_HUMAN","sp|O43251|RFOX2_HUMAN","sp|O43395|PRPF3_HUMAN","sp|O75962|TRIO_HUMAN","sp|O95573|ACSL3_HUMAN","sp|O95785|WIZ_HUMAN","sp|P02925|RBSB_ECOLI","sp|P02931|OMPF_ECOLI","sp|P07639|AROB_ECOLI","sp|P07650|TYPH_ECOLI","sp|P08195|4F2_HUMAN","sp|P08574|CY1_HUMAN","sp|P0A805|RRF_ECOLI","sp|P0A8N3|SYK1_ECOLI","sp|P0AC33|FUMA_ECOLI","sp|P0AG51|RL30_ECOLI","sp|P0AGG2|TESB_ECOLI","sp|P16144|ITB4_HUMAN","sp|P19387|RPB3_HUMAN","sp|P20839|IMDH1_HUMAN","sp|P21926|CD9_HUMAN","sp|P28340|DPOD1_HUMAN","sp|P28635|METQ_ECOLI","sp|P48444|COPD_HUMAN","sp|P50579|MAP2_HUMAN","sp|P52434|RPAB3_HUMAN","sp|P54760|EPHB4_HUMAN","sp|P61024|CKS1_HUMAN","sp|P61457|PHS_HUMAN","sp|P80303|NUCB2_HUMAN","sp|P82650|RT22_HUMAN","sp|Q05932|FOLC_HUMAN","sp|Q08380|LG3BP_HUMAN","sp|Q12874|SF3A3_HUMAN","sp|Q14696|MESD_HUMAN","sp|Q14C86|GAPD1_HUMAN","sp|Q15018|ABRX2_HUMAN","sp|Q15149|PLEC_HUMAN","sp|Q15172|2A5A_HUMAN","sp|Q16512|PKN1_HUMAN","sp|Q5TDH0|DDI2_HUMAN","sp|Q6NYC1|JMJD6_HUMAN","sp|Q86SQ4|AGRG6_HUMAN","sp|Q86U90|YRDC_HUMAN","sp|Q8N4L2|PP4P2_HUMAN","sp|Q8NBL1|PGLT1_HUMAN","sp|Q8ND04|SMG8_HUMAN","sp|Q8TC07|TBC15_HUMAN","sp|Q8WWM7|ATX2L_HUMAN","sp|Q92598|HS105_HUMAN","sp|Q92896|GSLG1_HUMAN","sp|Q93052|LPP_HUMAN","sp|Q96A49|SYAP1_HUMAN","sp|Q96A72|MGN2_HUMAN","sp|Q96AG4|LRC59_HUMAN","sp|Q96K37|S35E1_HUMAN","sp|Q99816|TS101_HUMAN","sp|Q99836|MYD88_HUMAN","sp|Q9BV86|NTM1A_HUMAN","sp|Q9BW83|IFT27_HUMAN","sp|Q9C0B1|FTO_HUMAN","sp|Q9H0U3|MAGT1_HUMAN","sp|Q9H307|PININ_HUMAN","sp|Q9H773|DCTP1_HUMAN","sp|Q9H9Y6|RPA2_HUMAN","sp|Q9NP72|RAB18_HUMAN","sp|Q9NR45|SIAS_HUMAN","sp|Q9NUQ8|ABCF3_HUMAN","sp|Q9NX40|OCAD1_HUMAN","sp|Q9NX58|LYAR_HUMAN","sp|Q9UBI1|COMD3_HUMAN","sp|Q9UHD1|CHRD1_HUMAN","sp|Q9UJ83|HACL1_HUMAN","sp|Q9UJX3|APC7_HUMAN","sp|Q9UKZ1|CNO11_HUMAN","sp|Q9UL46|PSME2_HUMAN","sp|Q9Y262|EIF3L_HUMAN","sp|Q9Y3Y2|CHTOP_HUMAN","sp|Q9Y5N5|N6MT1_HUMAN","sp|Q9Y6A5|TACC3_HUMAN","sp|P04846|NLPA_ECOLI","sp|Q13415|ORC1_HUMAN","sp|Q12933|TRAF2_HUMAN","sp|Q6R327|RICTR_HUMAN"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","set":"SharedData987c1d8b","name":"WaldTest_moderated","legendgroup":"WaldTest_moderated","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[19.7244150576911,34.7077912349502,null,19.7244150576911,34.7077912349502],"y":[-1,-1,null,1,1],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[19.7244150576911,34.7077912349502,null,19.7244150576911,34.7077912349502],"y":[-1,-1,null,1,1],"text":"","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":39.5141341357194,"r":7.30593607305936,"b":41.7789743183678,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.496086105675147],"automargin":true,"type":"linear","autorange":false,"range":[19.7244150576911,34.7077912349502],"tickmode":"array","ticktext":["20","25","30"],"tickvals":[20,25,30],"categoryorder":"array","categoryarray":["20","25","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"annotations":[{"text":"avgAbd","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.9178082191781},{"text":"diff","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-21.9178082191781},{"text":"AvsC","x":0.248043052837573,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"dila - dilb","x":0.751956947162427,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.9283360108783,1.18706361956563],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.496086105675147,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.496086105675147,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.503913894324853,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.503913894324853,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[19.7244150576911,34.7077912349502],"tickmode":"array","ticktext":["20","25","30"],"tickvals":[20,25,30],"categoryorder":"array","categoryarray":["20","25","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.503913894324853,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"modelName","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative","dragmode":"zoom"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4e6e5e22ce4c":{"x":{},"y":{},"text":{},"colour":{},"type":"scatter"},"4e6e3f160fdc":{"yintercept":{}}},"cur_data":"4e6e5e22ce4c","visdat":{"4e6e5e22ce4c":["function (y) ","x"],"4e6e3f160fdc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData987c1d8b"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
MA plot
</p>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myProteinIDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp|Q12246|LCB4_YEAST"</span>,  <span class="st">"sp|P38929|ATC2_YEAST"</span>,  <span class="st">"sp|Q99207|NOP14_YEAST"</span><span class="op">)</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contrdf</span>, <span class="va">protein_Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">myProteinIDS</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 0 × 13</span></span>
<span class="co">## <span style="color: #949494;"># … with 13 variables: modelName &lt;chr&gt;, protein_Id &lt;chr&gt;, contrast &lt;chr&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   diff &lt;dbl&gt;, std.error &lt;dbl&gt;, avgAbd &lt;dbl&gt;, statistic &lt;dbl&gt;, df &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   p.value &lt;dbl&gt;, conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, sigma &lt;dbl&gt;, FDR &lt;dbl&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="contrasts-with-missing-value-imputation">Contrasts with missing value imputation<a class="anchor" aria-label="anchor" href="#contrasts-with-missing-value-imputation"></a>
</h2>
<p>Use this method if there proteins with no observations in one of the
groups.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mC</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ContrastsSimpleImpute.html">ContrastsSimpleImpute</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>lfqdata <span class="op">=</span> <span class="va">transformed</span>, contrasts <span class="op">=</span> <span class="va">Contrasts</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mC</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "modelName"  "contrast"   "protein_Id" "diff"       "avgAbd"    </span>
<span class="co">##  [6] "df"         "sigma"      "std.error"  "statistic"  "p.value"   </span>
<span class="co">## [11] "conf.low"   "conf.high"  "FDR"</span></code></pre>
<p>Merging both results.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/addContrastResults.html">addContrastResults</a></span><span class="op">(</span>prefer <span class="op">=</span> <span class="va">contr</span>,add <span class="op">=</span> <span class="va">mC</span><span class="op">)</span><span class="op">$</span><span class="va">merged</span>
<span class="va">plotter</span> <span class="op">&lt;-</span> <span class="va">merged</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">plotter</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span>
<span class="va">tmp</span><span class="op">$</span><span class="va">FDR</span></code></pre></div>
<p><img src="Comparing2Groups_files/figure-html/mergeResults-1.png" width="700"></p>
<p>Look at proteins which could not be fitted using the linear model, if
any.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/addContrastResults.html">addContrastResults</a></span><span class="op">(</span>prefer <span class="op">=</span> <span class="va">contr</span>,add <span class="op">=</span> <span class="va">mC</span><span class="op">)</span>

<span class="va">moreProt</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span>
<span class="va">moreProt</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">moreProt</span><span class="op">$</span><span class="va">data</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">protein_Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">merged</span><span class="op">$</span><span class="va">more</span><span class="op">$</span><span class="va">contrast_result</span><span class="op">$</span><span class="va">protein_Id</span><span class="op">)</span>
<span class="va">moreProt</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">raster</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## NULL</span></code></pre>
</div>
<div class="section level2">
<h2 id="gsea-analyis">GSEA Analyis<a class="anchor" aria-label="anchor" href="#gsea-analyis"></a>
</h2>
<p>We can rank the proteins based on the log2FC or the t-statistic and
subject them them to gene set enrichment analysis (see GSEA).</p>
<p>This example will run only if the following packages are installed on
you machine:</p>
<ul>
<li>clusterProfiler (Bioconductor)</li>
<li>org.Sc.sgd.db (Bioconductor)</li>
<li>prora (github.com/protviz/prora)</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">evalAll</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"clusterProfiler"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"org.Sc.sgd.db"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"prora"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clusterProfiler</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Sc.sgd.db</span><span class="op">)</span>

<span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/get_UniprotID_from_fasta_header.html">get_UniprotID_from_fasta_header</a></span><span class="op">(</span><span class="va">merged</span><span class="op">$</span><span class="va">merged</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span>,
                                             idcolumn <span class="op">=</span> <span class="st">"protein_Id"</span><span class="op">)</span>
<span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu">prora</span><span class="fu">::</span><span class="fu">map_ids_uniprot</span><span class="op">(</span><span class="va">bb</span><span class="op">)</span>
<span class="va">ranklist</span> <span class="op">&lt;-</span> <span class="va">bb</span><span class="op">$</span><span class="va">statistic</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ranklist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">bb</span><span class="op">$</span><span class="va">P_ENTREZGENEID</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu">gseGO</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">ranklist</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  OrgDb <span class="op">=</span> <span class="va">org.Sc.sgd.db</span>,
  ont <span class="op">=</span> <span class="st">"ALL"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ridgeplot</span><span class="op">(</span> <span class="va">res</span> <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/graphics-defunct.html" class="external-link">dotplot</a></span><span class="op">(</span><span class="va">res</span> , showCategory <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">enrichplot</span><span class="fu">::</span><span class="fu">upsetplot</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
