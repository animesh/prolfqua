<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modelling dataset with two Factors • prolfqua</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modelling dataset with two Factors">
<meta property="og:description" content="prolfqua">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prolfqua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing2Groups.html">Comparing Two Groups with prolfqua</a>
    </li>
    <li>
      <a href="../articles/CreatingConfigurations.html">Creating prolfqua Configurations</a>
    </li>
    <li>
      <a href="../articles/Modelling2Factors.html">Modelling dataset with two Factors</a>
    </li>
    <li>
      <a href="../articles/QCandSampleSize.html">Quality Control &amp; Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/QualityControlAndSampleSizeEstimation.html">QC and Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_HL_Skyline.html">Supplement - Data preprocessing of SRM Heavy Light data</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_Skyline_PRM.html">Supplement - Data preprocessing for PRM</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyCorrelationAnalysis.html">Supplement - Filter precursors or fragments based on correlation</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary.html">Supplement - Summarize SRM Peptide Level Measurements</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary_HL.html">Supplement - Summarize heavy light Peptide Level Measurements</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolski/prolfqua/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Modelling dataset with two Factors</h1>
                        <h4 data-toc-skip class="author">Witold E.
Wolski</h4>
            
            <h4 data-toc-skip class="date">2022-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolski/prolfqua/blob/HEAD/../vignettes/Modelling2Factors.Rmd" class="external-link"><code>../vignettes/Modelling2Factors.Rmd</code></a></small>
      <div class="hidden name"><code>Modelling2Factors.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>In this vignette we demonstrate how to integrate more than one factor
into the linear models. Here, we show how to model the data with two
factors plus the interaction thereof. The underlying dataset is
generated in a course that is held on a yearly base. The context is that
yeast is in one condition grown on glucose and in the other condition
yeast is grown on glycerol and ethanol. Here we are looking into the
results of two different coursess where of course different people in
the wetlab and here even with different LC-MS instruments are involved.
It is therefore important to include the batch variable for these two
<em>similar</em> datasets. For demonstration purposes we are also
modelling the interaction between the two explanatory variables
<em>batch</em> and <em>condition</em>. In this case, having a
significant interaction term would mean the protein is expressed more in
the Glucose condition in one batch while the same protein is more
abundant in the Ethanol condition in the other batch.</p>
</div>
<div class="section level2">
<h2 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>For more details how the dataset <code>data_Yeast2Factor</code> was
created we refer you to the prolfquabenchmark vignettes. Interesting
here is the definition of the model. If interaction shall be included in
the model a <em>asterix</em> should be used while if no interaction
should be taken into account a <em>plus</em> should be used in the model
definition.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">conflicted</span><span class="fu">::</span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflict_prefer.html" class="external-link">conflict_prefer</a></span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_Yeast2Factor</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/prolfqua_data.html">prolfqua_data</a></span><span class="op">(</span><span class="st">"data_Yeast2Factor"</span><span class="op">)</span></span>
<span><span class="va">data_Yeast2Factor</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data_Yeast2Factor</span><span class="op">$</span><span class="va">data</span>, <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/old2new.html">old2new</a></span><span class="op">(</span><span class="va">data_Yeast2Factor</span><span class="op">$</span><span class="va">config</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pMerged</span> <span class="op">&lt;-</span> <span class="va">data_Yeast2Factor</span></span>
<span><span class="va">pMerged</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Run_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pMerged</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">Run_ID</span><span class="op">)</span></span>
<span><span class="va">pMerged</span><span class="op">$</span><span class="fu">factors</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 18 × 4</span></span></span>
<span><span class="co">##    sampleName       condition_ batch_ Run_ID</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Ethanol~p2370~06 Ethanol    p2370       6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Ethanol~p2370~08 Ethanol    p2370       8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Ethanol~p2370~09 Ethanol    p2370       9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Ethanol~p2370~12 Ethanol    p2370      12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Ethanol~p2691~03 Ethanol    p2691       3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Ethanol~p2691~06 Ethanol    p2691       6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Ethanol~p2691~09 Ethanol    p2691       9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Ethanol~p2691~10 Ethanol    p2691      10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Ethanol~p2691~12 Ethanol    p2691      12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Glucose~p2370~02 Glucose    p2370       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> Glucose~p2370~04 Glucose    p2370       4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> Glucose~p2370~07 Glucose    p2370       7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> Glucose~p2370~10 Glucose    p2370      10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> Glucose~p2370~11 Glucose    p2370      11</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> Glucose~p2691~04 Glucose    p2691       4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> Glucose~p2691~05 Glucose    p2691       5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> Glucose~p2691~08 Glucose    p2691       8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> Glucose~p2691~11 Glucose    p2691      11</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula_Batches</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/strategy.html">strategy_lm</a></span><span class="op">(</span><span class="st">"transformedIntensity ~ condition_ * batch_ "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify model definition</span></span>
<span><span class="va">Contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Glucose - Ethanol"</span> <span class="op">=</span> <span class="st">"condition_Glucose - condition_Ethanol"</span>,</span>
<span>               <span class="st">"p2370 - p2691"</span> <span class="op">=</span> <span class="st">"batch_p2370 - batch_p2691"</span>,</span>
<span>               <span class="st">"Glucose_vs_Ethanol_gv_p2370"</span> <span class="op">=</span> <span class="st">"`condition_Glucose:batch_p2370` - `condition_Ethanol:batch_p2370`"</span>,</span>
<span>               <span class="st">"Glucose_vs_Ethanol_gv_p2691"</span> <span class="op">=</span> <span class="st">"`condition_Glucose:batch_p2691` - `condition_Ethanol:batch_p2691`"</span>,</span>
<span>               <span class="st">"Interaction"</span> <span class="op">=</span> <span class="st">"`Glucose_vs_Ethanol_gv_p2370` - `Glucose_vs_Ethanol_gv_p2691`"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/build_model.html">build_model</a></span><span class="op">(</span><span class="va">pMerged</span><span class="op">$</span><span class="va">data</span>, <span class="va">formula_Batches</span>,</span>
<span>  subject_Id <span class="op">=</span> <span class="va">pMerged</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">hierarchy_keys</span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="fu">anova_histogram</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<div class="figure">
<img src="Modelling2Factors_files/figure-html/anovaPvaluePlots-1.png" alt="p-value distributions for ANOVA analysis." width="700"><p class="caption">
p-value distributions for ANOVA analysis.
</p>
</div>
<div class="section level3">
<h3 id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h3>
<p>Examine proteins with a significant interaction between the two
factors treatment and batch.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ANOVA</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">get_anova</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ANOVA</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">factor</span> <span class="op">==</span> <span class="st">"condition_:batch_"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">FDR.Pr..F.</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 10</span></span></span>
<span><span class="co">##   protein_Id  isSin…¹ nrcoef factor    Df Sum.Sq Mean.Sq F.value  Pr..F. FDR.P…²</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> sp|P36095|… FALSE        4 condi…     1  11.0    11.0     79.0 9.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span> 0.003<span style="text-decoration: underline;">04</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> sp|Q12159|… FALSE        4 condi…     1   4.86    4.86    33.9 4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 0.007<span style="text-decoration: underline;">15</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> sp|P09624|… FALSE        4 condi…     1   1.40    1.40    27.5 1.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.013<span style="text-decoration: underline;">3</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> sp|Q08225|… FALSE        4 condi…     1   3.59    3.59    24.2 2.83<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.022<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> sp|P32783|… FALSE        4 condi…     1   7.90    7.90    37.4 4.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 0.031<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​isSingular, ²​FDR.Pr..F.</span></span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">protIntSig</span> <span class="op">&lt;-</span> <span class="va">ANOVA</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">factor</span> <span class="op">==</span> <span class="st">"condition_:batch_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">FDR.Pr..F.</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">protInt</span> <span class="op">&lt;-</span>  <span class="va">pMerged</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">protInt</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">protInt</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">protInt</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">protein_Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">protIntSig</span><span class="op">$</span><span class="va">protein_Id</span>,<span class="op">]</span></span></code></pre></div>
<p>These proteins (here the top five) can easily be visualized using the
<code>boxplot</code> function from the <code>plotter</code> objects in
prolfqua</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">protInt</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">boxplots</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">boxplot</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Modelling2Factors_files/figure-html/unnamed-chunk-1-1.png" alt="Proteins with FDR &lt; 0.05 for condition batch interaction in ANOVA." width="700"><p class="caption">
Proteins with FDR &lt; 0.05 for condition batch interaction in ANOVA.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="compute-and-analyse-with-the-specified-contrasts">Compute and analyse with the specified contrasts<a class="anchor" aria-label="anchor" href="#compute-and-analyse-with-the-specified-contrasts"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/ContrastsModerated.html">ContrastsModerated</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/Contrasts.html">Contrasts</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, <span class="va">Contrasts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contrdf</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotter</span> <span class="op">&lt;-</span> <span class="va">contr</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plotter</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $FDR</span></span></code></pre>
<p><img src="Modelling2Factors_files/figure-html/visualiseResults-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotter</span><span class="op">$</span><span class="fu">ma_plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Modelling2Factors_files/figure-html/visualiseResults-2.png" width="700"></p>
<div class="section level3">
<h3 id="analyse-contrasts-with-missing-data-imputation">Analyse contrasts with missing data imputation<a class="anchor" aria-label="anchor" href="#analyse-contrasts-with-missing-data-imputation"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pMerged</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="fu">factor_keys_depth</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "condition_" "batch_"</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrSimple</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/ContrastsSimpleImpute.html">ContrastsSimpleImpute</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">pMerged</span>, <span class="va">Contrasts</span><span class="op">)</span></span>
<span><span class="va">contrdfSimple</span> <span class="op">&lt;-</span> <span class="va">contrSimple</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">contrSimple</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pl</span><span class="op">$</span><span class="fu">histogram_diff</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Modelling2Factors_files/figure-html/prepareForGroupAverageImputation-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $p.value</span></span></code></pre>
<p><img src="Modelling2Factors_files/figure-html/prepareForGroupAverageImputation-2.png" width="700"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## $FDR</span></span></code></pre>
<p><img src="Modelling2Factors_files/figure-html/prepareForGroupAverageImputation-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="merge-nonimputed-and-imputed-data-">Merge nonimputed and imputed data.<a class="anchor" aria-label="anchor" href="#merge-nonimputed-and-imputed-data-"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">contr</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1695   13</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">contrSimple</span><span class="op">$</span><span class="fu">get_contrasts</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2500   13</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mergedContrasts</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/merge_contrasts_results.html">merge_contrasts_results</a></span><span class="op">(</span>prefer <span class="op">=</span> <span class="va">contr</span>, add <span class="op">=</span> <span class="va">contrSimple</span><span class="op">)</span><span class="op">$</span><span class="va">merged</span></span>
<span><span class="va">cM</span> <span class="op">&lt;-</span> <span class="va">mergedContrasts</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">cM</span><span class="op">$</span><span class="fu">volcano</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot</span><span class="op">$</span><span class="va">FDR</span></span></code></pre></div>
<p><img src="Modelling2Factors_files/figure-html/doGroupAverageImputation-1.png" width="700"></p>
<div class="section level4">
<h4 id="look-at-proteins-with-significant-interaction-term-">Look at Proteins with significant interaction term.<a class="anchor" aria-label="anchor" href="#look-at-proteins-with-significant-interaction-term-"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigInteraction</span> <span class="op">&lt;-</span> <span class="va">mergedContrasts</span><span class="op">$</span><span class="va">contrast_result</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">contrast</span> <span class="op">==</span> <span class="st">"Interaction"</span> <span class="op">&amp;</span> <span class="va">FDR</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">protInt</span> <span class="op">&lt;-</span>  <span class="va">pMerged</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">protInt</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">protInt</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">protInt</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">protein_Id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sigInteraction</span><span class="op">$</span><span class="va">protein_Id</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">protInt</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">raster</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Modelling2Factors_files/figure-html/visualiseSomeProteins-1.png" alt="Heatmap for proteins that are quantified only in one condition." width="700"><p class="caption">
Heatmap for proteins that are quantified only in one condition.
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="va">protInt</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">heatmap</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hm</span></span></code></pre></div>
<div class="figure">
<img src="Modelling2Factors_files/figure-html/interactionHeatmap-1.png" alt="Proteinheatmap for proteins with significant Interactions" width="700"><p class="caption">
Proteinheatmap for proteins with significant Interactions
</p>
</div>
<p>The <code>prolfqua</code> package is described in <span class="citation">(Wolski et al. 2022)</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Monterey 12.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] httr_1.4.4         sass_0.4.2         tidyr_1.2.1        jsonlite_1.8.2    </span></span>
<span><span class="co">##  [5] viridisLite_0.4.1  carData_3.0-5      bslib_0.4.0        assertthat_0.2.1  </span></span>
<span><span class="co">##  [9] conflicted_1.1.0   highr_0.9          vipor_0.4.5        yaml_2.3.6        </span></span>
<span><span class="co">## [13] progress_1.2.2     ggrepel_0.9.1      pillar_1.8.1       backports_1.4.1   </span></span>
<span><span class="co">## [17] glue_1.6.2         digest_0.6.30      RColorBrewer_1.1-3 ggsignif_0.6.4    </span></span>
<span><span class="co">## [21] colorspace_2.0-3   cowplot_1.1.1      htmltools_0.5.3    pkgconfig_2.0.3   </span></span>
<span><span class="co">## [25] pheatmap_1.0.12    broom_1.0.1        purrr_0.3.5        scales_1.2.1      </span></span>
<span><span class="co">## [29] tibble_3.1.8       generics_0.1.3     farver_2.1.1       car_3.1-1         </span></span>
<span><span class="co">## [33] ggplot2_3.3.6      ellipsis_0.3.2     ggpubr_0.4.0       cachem_1.0.6      </span></span>
<span><span class="co">## [37] withr_2.5.0        lazyeval_0.2.2     cli_3.4.1          magrittr_2.0.3    </span></span>
<span><span class="co">## [41] crayon_1.5.2       memoise_2.0.1      evaluate_0.17      fs_1.5.2          </span></span>
<span><span class="co">## [45] fansi_1.0.3        MASS_7.3-58.1      rstatix_0.7.0      forcats_0.5.2     </span></span>
<span><span class="co">## [49] beeswarm_0.4.0     textshaping_0.3.6  tools_4.2.1        data.table_1.14.4 </span></span>
<span><span class="co">## [53] prettyunits_1.1.1  hms_1.1.2          lifecycle_1.0.3    stringr_1.4.1     </span></span>
<span><span class="co">## [57] plotly_4.10.0      munsell_0.5.0      compiler_4.2.1     pkgdown_2.0.6     </span></span>
<span><span class="co">## [61] jquerylib_0.1.4    systemfonts_1.0.4  prolfqua_1.0.0     rlang_1.0.6       </span></span>
<span><span class="co">## [65] grid_4.2.1         htmlwidgets_1.5.4  labeling_0.4.2     rmarkdown_2.17    </span></span>
<span><span class="co">## [69] gtable_0.3.1       abind_1.4-5        DBI_1.1.3          R6_2.5.1          </span></span>
<span><span class="co">## [73] gridExtra_2.3      knitr_1.40         dplyr_1.0.10       fastmap_1.1.0     </span></span>
<span><span class="co">## [77] utf8_1.2.2         rprojroot_2.0.3    ragg_1.2.3         desc_1.4.2        </span></span>
<span><span class="co">## [81] stringi_1.7.8      ggbeeswarm_0.6.0   Rcpp_1.0.9         vctrs_0.4.2       </span></span>
<span><span class="co">## [85] tidyselect_1.2.0   xfun_0.34</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Wolski2022.06.07.494524" class="csl-entry">
Wolski, Witold E., Paolo Nanni, Jonas Grossmann, Maria d’Errico, Ralph
Schlapbach, and Christian Panse. 2022. <span>“Prolfqua: A Comprehensive
<span class="nocase">R-package</span> for Proteomics Differential
Expression Analysis.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2022.06.07.494524" class="external-link">https://doi.org/10.1101/2022.06.07.494524</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
