<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QC and Sample Size Estimation • prolfqua</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="QC and Sample Size Estimation">
<meta property="og:description" content="prolfqua">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prolfqua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing2Groups.html">Comparing Two Groups</a>
    </li>
    <li>
      <a href="../articles/CreatingConfigurations.html">Creating prolfqua Configurations</a>
    </li>
    <li>
      <a href="../articles/ModelWithInteractions.html">Modelling with Interactions.</a>
    </li>
    <li>
      <a href="../articles/Modelling2Factors.html">Modelling Dataset with two Factors.</a>
    </li>
    <li>
      <a href="../articles/QCandSampleSize.html">Quality Control &amp; Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/QualityControlAndSampleSizeEstimation.html">QC and Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_HL_Skyline.html">Supplement - Data preprocessing of SRM Heavy Light data</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyAnalysis_Skyline_PRM.html">Supplement - Data preprocessing for PRM</a>
    </li>
    <li>
      <a href="../articles/Supplement_TidyCorrelationAnalysis.html">Supplement - Filter precursors or fragments based on correlation</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary.html">Supplement - Summarize SRM Peptide Level Measurements</a>
    </li>
    <li>
      <a href="../articles/Supplement_srm_summary_HL.html">Supplement - Summarize heavy light Peptide Level Measurements</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolski/prolfqua/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>QC and Sample Size Estimation</h1>
                        <h4 data-toc-skip class="author">Witold
Wolski</h4>
            
            <h4 data-toc-skip class="date">14/12/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolski/prolfqua/blob/HEAD/../vignettes/QualityControlAndSampleSizeEstimation.Rmd" class="external-link"><code>../vignettes/QualityControlAndSampleSizeEstimation.Rmd</code></a></small>
      <div class="hidden name"><code>QualityControlAndSampleSizeEstimation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="loading-data">Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<p>Load the data from MaxQuant proteinGroups.txt file.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datadir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"prolfqua"</span><span class="op">)</span> , <span class="st">"samples/maxquant_txt"</span><span class="op">)</span></span>
<span><span class="va">inputMQfile</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"tiny2.zip"</span><span class="op">)</span></span>
<span><span class="va">inputAnnotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">datadir</span>, <span class="st">"annotation_Ionstar2018_PXD003881.xlsx"</span><span class="op">)</span></span>
<span><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/tidyMQ_ProteinGroups.html">tidyMQ_ProteinGroups</a></span><span class="op">(</span><span class="va">inputMQfile</span><span class="op">)</span></span></code></pre></div>
<p>Read the annotation with the explanatory variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">inputAnnotation</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">annotation</span>, <span class="va">startdata</span>, by <span class="op">=</span> <span class="st">"raw.file"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">startdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">##   raw.file   run_ID date  sample prote…¹ major…² nr.pe…³ fasta…⁴ prote…⁵ prote…⁶</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> b03_02_15… 02     1503… b      CON__P… CON__P…       2 <span style="color: #949494;">""</span>           15    5.30</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> b03_02_15… 02     1503… b      REV__s… REV__s…       1 <span style="color: #949494;">"</span>sp|Q9…     107    2.05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> b03_02_15… 02     1503… b      sp|O00… sp|O00…       7 <span style="color: #949494;">"</span>sp|O0…     185   32.6 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> b03_02_15… 02     1503… b      sp|O14… sp|O14…       2 <span style="color: #949494;">"</span>sp|O1…     236   10.9 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> b03_02_15… 02     1503… b      sp|O43… sp|O43…       3 <span style="color: #949494;">"</span>sp|O4…     326    7.21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> b03_02_15… 02     1503… b      sp|O43… sp|O43…      11 <span style="color: #949494;">"</span>sp|O4…     341   40.7 </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 4 more variables: proteinID &lt;chr&gt;, mq.protein.intensity &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   mq.protein.lfq.intensity &lt;dbl&gt;, mq.protein.ms.ms.count &lt;int&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​protein.ids, ²​majority.protein.ids,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​nr.peptides, ⁴​fasta.headers, ⁵​protein.group.id, ⁶​protein.score</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
<p>For the sample size estimation we will use bio-reps from the
<em>a</em> dilution. We also remove all proteins identified only by a
single peptide.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="va">startdata</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample</span>  <span class="op">==</span> <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">startdata</span> <span class="op">&lt;-</span> <span class="va">startdata</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nr.peptides</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We need to <em>tell</em> <code>prolfqua</code> which columns in the
table contain what information. This is done using the
<code>AnalysisTableAnnotation</code> class.</p>
<p>The <code>hierarchy</code> describes the structure of the MS data. In
this case we have only protein level measurements. In addition you need
to describe the factors of the analysis, i.e, the column containing the
explanatory variables. You also need to specify the column containing
the protein identifiers and the protein intensities.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atable</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/AnalysisTableAnnotation.html">AnalysisTableAnnotation</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">fileName</span> <span class="op">=</span> <span class="st">"raw.file"</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">hierarchy</span><span class="op">[[</span><span class="st">"protein_Id"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proteinID"</span><span class="op">)</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">hierarchyDepth</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="fu">set_work_intensity</span><span class="op">(</span><span class="st">"mq.protein.intensity"</span><span class="op">)</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">factors</span><span class="op">[[</span><span class="st">"dilution."</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="st">"sample"</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">factors</span><span class="op">[[</span><span class="st">"Run_ID"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="st">"run_ID"</span></span>
<span><span class="va">atable</span><span class="op">$</span><span class="va">factorDepth</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/AnalysisConfiguration.html">AnalysisConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">atable</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">adata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/setup_analysis.html">setup_analysis</a></span><span class="op">(</span><span class="va">startdata</span>, <span class="va">config</span><span class="op">)</span></span></code></pre></div>
<p>Create the LFQData class instance, remove zeros from data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">adata</span>, <span class="va">config</span><span class="op">)</span></span>
<span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">remove_small_intensities</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can convert the data into a data frame in wide format, where the
intensities of each sample occupy their own columns.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">to_wide</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   protein_Id              `a~10`   `a~11`   `a~20`   `a~21`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> CON__P02668           20<span style="text-decoration: underline;">452</span>000 25<span style="text-decoration: underline;">329</span>000 25<span style="text-decoration: underline;">253</span>000 24<span style="text-decoration: underline;">138</span>000</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> sp|O00401|WASL_HUMAN  49<span style="text-decoration: underline;">876</span>000 78<span style="text-decoration: underline;">810</span>000 49<span style="text-decoration: underline;">344</span>000 59<span style="text-decoration: underline;">340</span>000</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> sp|O14683|P5I11_HUMAN 45<span style="text-decoration: underline;">303</span>000 17<span style="text-decoration: underline;">463</span>000 52<span style="text-decoration: underline;">937</span>000 60<span style="text-decoration: underline;">960</span>000</span></span></code></pre>
<div class="section level3">
<h3 id="visualization-of-not-normalized-data">Visualization of not normalized data<a class="anchor" aria-label="anchor" href="#visualization-of-not-normalized-data"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqplotter</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lfqplotter</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="QualityControlAndSampleSizeEstimation_files/figure-html/makeMissingHeatmap-1.png" width="700"></p>
<div class="section level4">
<h4 id="visualization-of-missing-data">Visualization of missing data<a class="anchor" aria-label="anchor" href="#visualization-of-missing-data"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nah</span> <span class="op">&lt;-</span> <span class="va">lfqplotter</span><span class="op">$</span><span class="fu">NA_heatmap</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nah</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/printMissingHeatmap-1.png" alt="Heatmap, black - missing protein intensities, white - present" width="700"><p class="caption">
Heatmap, black - missing protein intensities, white - present
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Summariser</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">plot_missingness_per_group</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-7-1.png" alt="# of proteins with 0,1,...N missing values" width="700"><p class="caption">
# of proteins with 0,1,…N missing values
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Summariser</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">plot_missingness_per_group_cumsum</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-8-1.png" alt="Cumulative sum of the # of proteins with 0,1,...N missing values" width="700"><p class="caption">
Cumulative sum of the # of proteins with 0,1,…N missing values
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqplotter</span><span class="op">$</span><span class="fu">missigness_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-9-1.png" alt="Intensity distribution of proteins depending on # of missing values" width="700"><p class="caption">
Intensity distribution of proteins depending on # of missing values
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="computing-standard-deviations-mean-and-cv-">Computing standard deviations, mean and CV.<a class="anchor" aria-label="anchor" href="#computing-standard-deviations-mean-and-cv-"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stats_quantiles</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">wide</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"quantile of "</span>,<span class="va">stats</span><span class="op">$</span><span class="va">stat</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>quantile of CV</caption>
<thead><tr class="header">
<th align="right">probs</th>
<th align="right">a</th>
<th align="right">All</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">9.993088</td>
<td align="right">9.993088</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">12.742718</td>
<td align="right">12.742718</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">20.783568</td>
<td align="right">20.783568</td>
</tr>
<tr class="even">
<td align="right">0.75</td>
<td align="right">29.616325</td>
<td align="right">29.616325</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">42.777323</td>
<td align="right">42.777323</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density_median</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-10-1.png" alt="Distribution of CV's" width="700"><p class="caption">
Distribution of CV’s
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdm_raw</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stdv_vs_mean</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stdm_raw</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-11-1.png" alt="Scatter plot of standard deviation vs mean" width="700"><p class="caption">
Scatter plot of standard deviation vs mean
</p>
</div>
<div class="section level3">
<h3 id="normalize-protein-intensities">Normalize protein intensities<a class="anchor" aria-label="anchor" href="#normalize-protein-intensities"></a>
</h3>
<p>We normalize the data by first <span class="math inline">\(\log_2\)</span> transforming it and then
z-scaling. The <span class="math inline">\(log_2\)</span> stabilizes the
variance, while the z-scaling removes systematic differences from the
samples.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Transformer</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">transformed</span> <span class="op">&lt;-</span> <span class="va">lt</span><span class="op">$</span><span class="fu">log2</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">robscale</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lfq</span></span>
<span><span class="va">transformed</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">is_intensity_transformed</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pl</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotDensities-1.png" alt="Normalized intensities." width="700"><p class="caption">
Normalized intensities.
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span><span class="op">$</span><span class="fu">pairs_smooth</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotScatterMatrix-1.png" alt="Scatterplot matrix" width="700"><p class="caption">
Scatterplot matrix
</p>
</div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">heatmap</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: 5">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotheatmap-1.png" alt="Heatmap, Rows - proteins, Columns - samples" width="700"><p class="caption">
Heatmap, Rows - proteins, Columns - samples
</p>
</div>
<p>We can also look at the correlation among the samples.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">heatmap_cor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hc</span></span></code></pre></div>
<p><img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotHeatmapCor-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="fu">stats_quantiles</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">wide</span>, <span class="st">"Standard deviations"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Standard deviations</caption>
<thead><tr class="header">
<th align="right">probs</th>
<th align="right">a</th>
<th align="right">All</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">0.1252330</td>
<td align="right">0.1252330</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">0.1799588</td>
<td align="right">0.1799588</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">0.2593594</td>
<td align="right">0.2593594</td>
</tr>
<tr class="even">
<td align="right">0.75</td>
<td align="right">0.3766977</td>
<td align="right">0.3766977</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">0.6998894</td>
<td align="right">0.6998894</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density_median</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/sddensity-1.png" alt="Density of the standard deviation" width="700"><p class="caption">
Density of the standard deviation
</p>
</div>
<p>Check for heteroskedasticity. After transformation the sd should be
independent of the mean intensity.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdm_trans</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stdv_vs_mean</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stdm_trans</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/checkForHeteroskedasticity-1.png" alt="Scatter plot of sd vs mean of protein intensity" width="700"><p class="caption">
Scatter plot of sd vs mean of protein intensity
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#gridExtra::grid.arrange(stdm_raw, stdm_trans, nrow=1)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-sample-size">Estimate sample size<a class="anchor" aria-label="anchor" href="#estimate-sample-size"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density</span><span class="op">(</span>ggstat <span class="op">=</span> <span class="st">"ecdf"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-12-1.png" alt="Empirical cumulative density function of the standard deviation for all the proteins in the dataset." width="700"><p class="caption">
Empirical cumulative density function of the standard deviation for all
the proteins in the dataset.
</p>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">power_t_test_quantiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dilution.</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">sampleSize</span>, <span class="st">"Sample sizes. delta - Effect size, N - samplesize"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sample sizes. delta - Effect size, N - samplesize</caption>
<thead><tr class="header">
<th align="left">dilution.</th>
<th align="right">probs</th>
<th align="right">quantiles</th>
<th align="right">sdtrimmed</th>
<th align="right">N_exact</th>
<th align="right">N</th>
<th align="right">delta</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.10</td>
<td align="right">0.1252330</td>
<td align="right">0.1252330</td>
<td align="right">2.184177</td>
<td align="right">3</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.25</td>
<td align="right">0.1799588</td>
<td align="right">0.1799588</td>
<td align="right">2.822134</td>
<td align="right">3</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.50</td>
<td align="right">0.2593594</td>
<td align="right">0.2593594</td>
<td align="right">4.246057</td>
<td align="right">5</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.75</td>
<td align="right">0.3766977</td>
<td align="right">0.3766977</td>
<td align="right">7.492883</td>
<td align="right">8</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.90</td>
<td align="right">0.6998894</td>
<td align="right">0.6998894</td>
<td align="right">23.090693</td>
<td align="right">24</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.10</td>
<td align="right">0.1252330</td>
<td align="right">0.1252330</td>
<td align="right">1.772983</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.25</td>
<td align="right">0.1799588</td>
<td align="right">0.1799588</td>
<td align="right">2.014966</td>
<td align="right">3</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.50</td>
<td align="right">0.2593594</td>
<td align="right">0.2593594</td>
<td align="right">2.476882</td>
<td align="right">3</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.75</td>
<td align="right">0.3766977</td>
<td align="right">0.3766977</td>
<td align="right">3.502452</td>
<td align="right">4</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.90</td>
<td align="right">0.6998894</td>
<td align="right">0.6998894</td>
<td align="right">8.762314</td>
<td align="right">9</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.10</td>
<td align="right">0.1252330</td>
<td align="right">0.1252330</td>
<td align="right">1.535918</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.25</td>
<td align="right">0.1799588</td>
<td align="right">0.1799588</td>
<td align="right">1.637050</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.50</td>
<td align="right">0.2593594</td>
<td align="right">0.2593594</td>
<td align="right">1.790985</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="right">0.75</td>
<td align="right">0.3766977</td>
<td align="right">0.3766977</td>
<td align="right">2.056740</td>
<td align="right">3</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.90</td>
<td align="right">0.6998894</td>
<td align="right">0.6998894</td>
<td align="right">3.228005</td>
<td align="right">4</td>
<td align="right">2.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> , y <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">delta</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-13-1.png" alt="Estimated sample sizes for various FC levels and various quantiles of the standard deviation." width="700"><p class="caption">
Estimated sample sizes for various FC levels and various quantiles of
the standard deviation.
</p>
</div>
<p>Getting statistics for each protein in each group. The information
includes group size, number of observations, standard deviation,
variance, mean.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="fu">stats</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   protein_Id            dilution.     n not_na     sd     var  mean</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> CON__P02668           a             4      4 0.060<span style="text-decoration: underline;">3</span> 0.003<span style="text-decoration: underline;">64</span>  24.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> sp|O00401|WASL_HUMAN  a             4      4 0.247  0.061<span style="text-decoration: underline;">1</span>   25.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> sp|O14683|P5I11_HUMAN a             4      4 0.915  0.838    25.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> sp|O43251|RFOX2_HUMAN a             4      4 0.290  0.084<span style="text-decoration: underline;">2</span>   24.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> sp|O43395|PRPF3_HUMAN a             4      4 0.263  0.069<span style="text-decoration: underline;">2</span>   26.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> sp|O75962|TRIO_HUMAN  a             4      4 0.370  0.137    26.9</span></span></code></pre>
<p>You can also estimate the sample size needed to perform differential
expression analysis for each protein, given the <code>power</code>,
<code>delta</code>, and <code>sig.level</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">power_t_test</span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span>,power <span class="op">=</span> <span class="fl">0.8</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dilution.</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,<span class="va">protein_Id</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="op">]</span>, caption <span class="op">=</span> <span class="st">"Sample size for each protein"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Sample size for each protein</caption>
<colgroup>
<col width="32%">
<col width="10%">
<col width="3%">
<col width="7%">
<col width="10%">
<col width="10%">
<col width="9%">
<col width="6%">
<col width="9%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="left">protein_Id</th>
<th align="left">dilution.</th>
<th align="right">n</th>
<th align="right">not_na</th>
<th align="right">sd</th>
<th align="right">var</th>
<th align="right">mean</th>
<th align="right">delta</th>
<th align="right">N_exact</th>
<th align="right">N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">sp|P07650|TYPH_ECOLI</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1.7739102</td>
<td align="right">3.1467575</td>
<td align="right">22.97323</td>
<td align="right">1</td>
<td align="right">50.37564</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="left">sp|Q6R327|RICTR_HUMAN</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1.2749781</td>
<td align="right">1.6255691</td>
<td align="right">23.75844</td>
<td align="right">1</td>
<td align="right">26.51329</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">sp|Q92896|GSLG1_HUMAN</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0.9887662</td>
<td align="right">0.9776585</td>
<td align="right">22.74865</td>
<td align="right">1</td>
<td align="right">16.36531</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">sp|O14683|P5I11_HUMAN</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0.9154357</td>
<td align="right">0.8380226</td>
<td align="right">25.26318</td>
<td align="right">1</td>
<td align="right">14.18273</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">sp|Q12933|TRAF2_HUMAN</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">0.8529473</td>
<td align="right">0.7275191</td>
<td align="right">22.86506</td>
<td align="right">1</td>
<td align="right">12.45794</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">sp|Q6NYC1|JMJD6_HUMAN</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0.8255164</td>
<td align="right">0.6814774</td>
<td align="right">23.59539</td>
<td align="right">1</td>
<td align="right">11.74020</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">sp|P28635|METQ_ECOLI</td>
<td align="left">a</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0.7959310</td>
<td align="right">0.6335061</td>
<td align="right">23.74717</td>
<td align="right">1</td>
<td align="right">10.99315</td>
<td align="right">11</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">delta</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-14-1.png" alt="Distribution of the required sample sizes for three fold change thresholds for all the proteins." width="700"><p class="caption">
Distribution of the required sample sizes for three fold change
thresholds for all the proteins.
</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
